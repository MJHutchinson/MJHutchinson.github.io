<!doctype html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

    <title>reveal.js</title>

    <link rel="stylesheet" href="dist/reset.css">
    <link rel="stylesheet" href="dist/reveal.css">
    <link rel="stylesheet" href="dist/theme/libertinus.css">

    <!-- Theme used for syntax highlighted code -->
    <!-- <link rel="stylesheet" href="plugin/highlight/monokai.css"> -->

    <!-- Custom css from alex -->
    <link rel="stylesheet" href="dist/utility.css">
</head>

<body class="reveal-viewport" style="--slide-width: 1280px; --slide-height: 800px;">
    <div class="reveal">
        <div class="slides">
            <section class="h-100" data-auto-animate="" style="display: block;" data-fragment="-1">
                <article class="justify-between h-100">
                    <div class="r-hstack justify-between items-start w-100 pt-5 fragment fade-out"
                        data-fragment-index="0">
                        <h2 class="h5">Viva Presentation</h2>
                    </div>
                    <div class="r-vstack w-100 h3">
                        <h1 class="text-nowrap my-0">Generative Modelling with Diffusions</h1>
                        <h1 class="text-nowrap my-0">on Riemannian Manifolds</h1>
                        <!-- <div class="r-hstack">
                            <h1 class="text-nowrap my-0">Score-Based</h1>
                            <h1 class="text-nowrap my-0">&nbsp;</h1>
                            <h1 class="text-nowrap my-0">Generative
                                Modelling</h1>
                        </div> -->
                    </div>
                    <div style="opacity: 40%;">Follow along at <a>mjhutchinson.info/viva</a></div>
                    <div class="r-hstack justify-between items-center w-100 fragment fade-out" data-fragment-index="0">
                        <div><img src="figures/logos/oxweb-logo-rect.svg"></div>
                        <div class="r-vstack items-end">
                            <h3 class="my-0 text-center">Michael Hutchinson</h3>
                            <h3 class="my-0 text-small-caps"><a href="https://mjhutchinson.info">mjhutchinson.info</a>
                            </h3>
                            <h3 class="my-0 text-small-caps"><a href="https://twitter.com/MHutchinson141"><span
                                        class="twitter"></span> @mhutchinson141</a></h3>
                        </div>
                    </div>

                </article>
            </section>

            <section data-auto-animate="" hidden="" aria-hidden="true" class="future" style="display: block;">
                <div class="r-hstack justify-start h5">
                    <h1>Why Riemannian Manifolds?</h1>
                </div>
                <div class="w-100 r-stretch r-vstack items-start justify-around mb-5 ">
                    <div class="columns">
                        <div class="column">
                            <div class="w-100 items-center">
                                <h5>Euclidean space</h5>
                            </div>
                            <!-- <img src="figures/torus_w_dist.png"> -->
                        </div>
                        <!-- <div class="column fragment fade-in"> -->
                        <div class="column">

                            <div class="w-100 items-center">
                                <h5>Torus</h5>
                            </div>
                            <img src="figures/intro/torus_w_dist.png">
                        </div>
                        <!-- <div class="column fragment fade-in"> -->
                        <div class="column">

                            <div class="w-100 items-center">
                                <h5>Sphere</h5>
                            </div>
                            <img src="figures/intro/sphere_w_dist.png">
                        </div>
                        <!-- <div class="column fragment fade-in"> -->
                        <div class="column">

                            <div class="w-100 items-center">
                                <h5>Hyperbolic space</h5>
                            </div>
                            <img src="figures/intro/hyperbolic_w_dist.png">
                        </div>
                    </div>
                    <div class="w-100 r-hstack items-center fragment">
                        <p class="mb-0">Locally: manifolds look Euclidean (flat); Globally: they look very
                            different</p>
                    </div>
                </div>
            </section>


            <section data-auto-animate="" hidden="" aria-hidden="true" class="future" style="display: block;">
                <div class="r-hstack justify-start h5">
                    <h1>Why Riemannian manifolds?</h1>
                </div>
                <div class="w-100 r-stretch r-vstack items-start justify-around mb-5 ">
                    <div class="columns h-50 w-100">
                        <!-- <div class="column fragment"> -->
                        <div class="column">
                            <div class="r-vstack h-100 w-100">
                                <img class="my-0" src="figures/intro/molecule.png">
                                <p class="text-center mt-0 small">Molecules</p>
                            </div>
                        </div>
                        <div class="column">
                            <div class="r-vstack h-100">
                                <img class="my-0" src="figures/intro/protein_binding.png">
                                <p class="text-center mt-0 small">Proteins</p>
                            </div>
                        </div>
                        <div class="column">
                            <div class="r-vstack h-100">
                                <img class="my-0" src="figures/intro/weather.png">
                                <p class="text-center mt-0 small">Climate data</p>
                            </div>
                        </div>
                    </div>
                    <div class="columns h-50 w-100">
                        <div class="column">
                            <div class="r-vstack h-100">
                                <img class="my-0" src="figures/intro/robot.png">
                                <p class="text-center mt-0 small">Robotics</p>
                            </div>
                        </div>
                        <div class="column">
                            <div class="r-vstack h-100">
                                <img class="my-0" src="figures/intro/liegroups.png">
                                <p class="text-center mt-0 small">Lie groups</p>
                            </div>
                        </div>
                        <div class="column">
                            <div class="r-vstack h-100">
                                <img class="my-0" src="figures/intro/tree.png">
                                <p class="text-center mt-0 small">Trees</p>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <section data-auto-animate="" hidden="" aria-hidden="true" class="future" style="display: block;">
                <div class="r-hstack justify-start h5">
                    <h1>Why Riemannian manifolds?</h1>
                </div>
                <div class="w-100 r-stretch r-vstack items-start justify-around mb-5 ">
                    <p class="w-100">Respecting the geometry of the underlying space is extremely important in
                        generative modelling</p>
                    <div class="w-100 columns">
                        <div class="column fragment">
                            <div class="w-100 r-vstack items-center">

                                <img src="figures/intro/r2_flat.png">
                                <p align="center" class="w-75">Generative modelling on a projected sphere</p>
                            </div>
                        </div>
                        <div class="column fragment">
                            <div class="w-100 r-vstack items-center">

                                <img src="figures/intro/s2_flat.png">
                                <p class="w-75">Generative modelling on the sphere natively</p>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <section data-auto-animate="" hidden="" aria-hidden="true" class="future" style="display: block;">
                <div class="r-hstack justify-start h5">
                    <h1>Why diffusion models?</h1>
                </div>
                <div class="w-100 r-stretch r-vstack items-start justify-around mb-5 ">
                    <div class="r-stretch columns items-start">
                        <div class="column mr-4 items-start justify-start r-vstack">
                            <h5 style="font-weight: bold;" class="fragment fade-in">Likelihood based models</h5>
                            <ul class="fragment fade-in">
                                <li>VAEs</li>
                                <li>Normalizing flows</li>
                                <li>Autoregressive models</li>
                                <li>Energy based models</li>
                            </ul>
                            <p class="fragment fade-in">These typically have restricted forms on the models, or are
                                trained
                                via surrogate
                                ELBOs.
                            </p>
                        </div>
                        <div class="column ml-4 items-start justify-start r-vstack">
                            <h5 style="font-weight: bold;" class="fragment fade-in">Implicit models</h5>
                            <ul class="fragment fade-in">
                                <li>GANs</li>
                            </ul>
                            <p class="fragment fade-in">The adversarial losses of these models can be very tricky to
                                train,
                                and we
                                have no access
                                to
                                likelihoods from the models.</p>
                        </div>
                    </div>
                    <div class="r-vstack mb-5 w-100">
                        <p class="fragment fade-in">What benefit do score based models bring?</p>
                        <ul>
                            <li class="fragment fade-in">Very fast training &rarr; Much faster than normalsing flows
                                &#128077</li>
                            <li class="fragment fade-in">Stationary, regression, objective &rarr; Much more stable than
                                GANs to train &#128077
                            </li>
                            <li class="fragment fade-in">Empirically exceptional results with minimal tricks &#128077
                            </li>
                        </ul>
                    </div>
                </div>
            </section>

            <section class="h-100" data-auto-animate="" style="display: block;">
                <div class="r-hstack justify-start h5">
                    <h1>Geometry & score-based modelling - A line of work</h1>
                </div>
                <article>
                    <div class="r-vstack w-100">
                        <div class="r-hstack w-100 items-start">
                            <div class="r-vstack w-25">
                                <!-- <img class="img-fluid w-75 mb-n3 mt-n4" src="figures/sphere_w_dist.png"> -->
                                <div class="w-75 mb-n3 mt-n4">
                                    <img class="column img-fluid my-0" src="figures/logos/rsgm.png" data-id="rsgm_pic">
                                </div>
                                <h2 class="my-0 small">
                                    <div data-id="title">Manifolds</div>
                                </h2>
                                <h3 class="my-0 footnotesize">
                                    <div data-id="conf">Neurips 2022</div>
                                </h3>
                            </div>
                            <div class="r-vstack w-25">
                            </div>
                            <div class="r-vstack w-25">
                                <img class="img-fluid" style="width: 65%"
                                    src="figures/logos/manifold_w_boundary_better.png">
                                <h2 class="my-0 small text-nowrap"><em>Better</em> Manifolds with Boundary</h2>
                                <h3 class="my-0 footnotesize">Neurips 2023</h3>
                            </div>
                            <div class="r-vstack w-25">
                            </div>
                        </div>
                        <img class="img-fluid w-100 mt-3 mb-1" style="max-width: 100% !important;"
                            src="figures/timeline.svg">
                        <div class="r-hstack w-100 items-start">
                            <div class="r-vstack w-25">
                            </div>
                            <div class="r-vstack w-25">
                                <img class="img-fluid" style="width: 65%" src="figures/logos/manifold_w_boundary.png"
                                    data-id="boundary_pic">
                                <h2 class="my-0 small text-nowrap">Manifolds with Boundary</h2>
                                <h3 class="my-0 footnotesize">TMLR 2023</h3>
                            </div>
                            <div class="r-vstack w-25">
                            </div>
                            <div class="r-vstack w-25">
                                <div class="r-hstack w-100">
                                    <img class="img-fluid w-50" src="figures/logos/geometric_ndp.png">
                                    <div class="mx-3" style="color: #002147;" data-id="amps">&</div>
                                    <img class="img-fluid w-50" src="figures/logos/field.svg">
                                </div>
                                <h2 class="my-0 small text-nowrap">Fields and Paths on Manifolds</h2>
                                <h3 class="my-0 footnotesize">Neurips 2023</h3>
                            </div>
                        </div>
                    </div>
                </article>
            </section>


            <section class="h-100" data-auto-animate="" style="display: block;" data-fragment="-1">
                <div class="r-hstack justify-start h5">
                    <h1>Research Outline</h1>
                </div>
                <div class="r-vstack justify-between h-75">
                    <div class="r-hstack w-100 items-end justify-around h-25 my-2">
                        <div class="r-vstack h-100" style="width: 300px;">
                            <img class="img-fluid h-75 my-0" src=" figures/logos/rsgm.png" data-id="rsgm_pic">
                            <h2 class="my-0 footnotesize text-nowrap">Manifolds</h2>
                        </div>
                        <div class="w-75 h-100 r-vstack items-center justify-around">
                            <ul class="small fragment">
                                <li>On Riemannian manifolds we cannot apply the Euclidean SDE framework.</li>
                                <li>Replace this with stochastic calculus.</li>
                                <li>Generalise the diffusion modelling toolbox for
                                    manifolds.</li>
                            </ul>
                        </div>
                    </div>

                    <div class="r-hstack w-100 items-end justify-around h-25 my-2">
                        <div class="r-vstack h-100" style="width: 300px;">
                            <img class="img-fluid h-75" style="margin-bottom: 5px" data-id="boundary_pic"
                                src=" figures/logos/manifold_w_boundary.png">
                            <h2 class="my-0 footnotesize text-nowrap">Manifolds with Boundary</h2>
                        </div>
                        <div class="w-75 h-100 r-vstack items-center justify-around">
                            <ul class="small fragment">
                                <li>When our spaces have boundaries, normal SDEs will escape.</li>
                                <li>Replace these with <em>log-barrier</em> and <em>reflected</em> SDEs.</li>
                                <li>Investigate these and show how to make them work in practise.</li>
                            </ul>
                        </div>
                    </div>
                    <div class="r-hstack w-100 items-end justify-around h-25 my-2">
                        <div class="r-vstack h-100" style="width: 300px;">
                            <img class="img-fluid h-75" style="margin-bottom: 5px"
                                src="figures/logos/manifold_w_boundary_better.png">
                            <h2 class="my-0 footnotesize text-nowrap"><em>Better</em> Manifolds with Boundary</h2>

                        </div>
                        <div class="w-75 h-100 r-vstack items-center justify-around">
                            <ul class="small fragment">
                                <li>Reflected SDEs are expensive to discretise in practise.</li>
                                <li>Introduce a new sampling scheme based on Metropolis sampling.</li>
                                <li>Show that this scheme works effectivly and very fast in practise.</li>
                            </ul>
                        </div>
                    </div>

                    <div class="r-hstack w-100 items-end justify-around h-25 my-2">
                        <div class="r-vstack h-100" style="width: 300px;">
                            <div class="r-hstack w-100" style="height: 65%;">
                                <img class="img-fluid h-100" src="figures/logos/geometric_ndp.png">
                                <div class="mx-3" style="color: #002147;" data-id="amps">&</div>
                                <img class="img-fluid h-100" src="figures/logos/field.svg">
                            </div>
                            <h2 class="my-0 footnotesize text-nowrap">Fields and Paths on Manifolds</h2>
                        </div>
                        <div class="w-75 h-100 r-vstack items-center justify-around">
                            <ul class="small fragment">
                                <li>What of we want to think not about distribution on manifolds but:</li>
                                <ul>
                                    <li>Distributions on <em>functions on manifolds</em>.</li>
                                    <li>Distributions on <em>paths on manifolds</em>.</li>
                                </ul>
                            </ul>
                        </div>
                    </div>
                </div>
            </section>

            <section data-auto-animate="" hidden="" aria-hidden="true" class="future" style="display: block;">
                <div class="r-stretch r-vstack items-center w-100">
                    <div class="r-vstack w-100">
                        <h1 class="h4" style="text-align: center;">Chapter 3: Score-based modelling on Riemannian
                            manifolds</h1>
                        <h1>
                            <div data-id="title">Based on <em>Riemannian Score-Based Generative Modelling, Neurips
                                    2022</em></div>
                        </h1>
                    </div>
                    <div class="r-hstack mt-4 w-75 items-start">
                        <div class="r-vstack mx-1" style="width: 16% !important;">
                            <img class="img-fluid face-circle" src="figures/faces/debortoli.jpg" style="height">
                            <h5 class="footnotesize my-0">Valentin<br>De Bortoli*</h5>
                        </div>
                        <div class="r-vstack mx-1" style="width: 16% !important;">
                            <img class="img-fluid face-circle" src="figures/faces/mathieu2.jpg" style="height">
                            <h5 class="footnotesize my-0">Émile<br>Mathieu*</h5>
                        </div>
                        <div class="r-vstack mx-1" style="width: 16% !important;">
                            <img class="img-fluid face-circle" src="figures/faces/hutchinson.jpg" style="height">
                            <h5 class="footnotesize my-0">Michael<br>Hutchinson*</h5>
                        </div>
                        <div class="r-vstack mx-1" style="width: 16% !important;">
                            <img class="img-fluid face-circle" src="figures/faces/thornton.jpg" style="height">
                            <h5 class="footnotesize my-0">James<br>Thornton</h5>
                        </div>
                        <div class="r-vstack mx-1" style="width: 16% !important;">
                            <img class="img-fluid face-circle" src="figures/faces/teh.png" style="height">
                            <h5 class="footnotesize my-0">Yee Whye<br>Teh</h5>
                        </div>
                        <div class="r-vstack mx-1" style="width: 16% !important;">
                            <img class="img-fluid face-circle" src="figures/faces/doucet.jpg" style="height">
                            <h5 class="footnotesize my-0">Arnaud<br>Doucet</h5>
                        </div>
                    </div>
                    <div class="scriptsize mt-4 p-div" style="opacity: 50%;">*equal contribution</div>
                    <div class="small" style="width: 85% !important; opacity: 80%;">
                        <p>Personal contributions: Project conception, practical methodology & code, some mathematical
                            results, some of the experiments.</p>
                    </div>
                </div>
            </section>

            <section data-auto-animate="" hidden="" aria-hidden="true" class="future" style="display: block;">
                <div class="r-hstack justify-start h5">
                    <h1 class="">What problem are we trying to solve?</h1>
                </div>
                <div class="r-vstack r-stretch items-center w-100">
                    <div class="r-hstack w-100 fragment">
                        <div class="" style="height: 300px">
                            <h5 class="my-0"><b>Euclidean SDE</b></h5>
                            <img src="figures/manifold/euclidean_sde.svg" class="my-0">
                        </div>
                        <div class="r-vstack items-center w-25">
                            <p>vs</p>
                        </div>
                        <div class="" style="height: 300px">
                            <h5 class="my-0"><b>Manifold SDE</b></h5>
                            <img src="figures/manifold/grw.png" class="my-0">
                        </div>
                    </div>
                    <p class="w-100 fragment">General manifolds lack two important things, <em>vector space
                            structure</em>, and
                        so no notion of <em>expectation</em>, and they are not <em>flat</em>, removing the uniqueness of
                        parallel transport.</p>
                    <p class="fragment">Tools to deal with this:</p>
                    <div class="w-100 columns items-start">
                        <div class="column r-vstack items-center fragment">
                            <h5><b>Test functions</b></h5>
                            <p class="mt-0">\(f: \c{M} \to \R\)</p>
                            <p class="mt-0">View of a process in 1D</p>
                        </div>
                        <div class="column r-vstack items-center fragment">
                            <h5><b>Chart gluing</b></h5>
                            <p class="mt-0">View process as patches of Euclidean space</p>
                        </div>
                        <div class="column r-vstack items-center fragment">
                            <h5><b>Nash embedding</b></h5>
                            <p class="mt-0">View process in a higher dim Euclidean space</p>
                        </div>
                    </div>
                </div>
            </section>


            <section hidden="" aria-hidden="true" class="future" style="display: block;">
                <div class="r-hstack justify-start h5">
                    <h1 class="">How did we adapt standard diffusion models?</h1>
                </div>
                <div class="r-stretch r-vstack w-100 items-center">
                    <div class="w-100 d-table">
                        <div class="d-table-row">
                            <div class="d-table-head">Ingredient \ Space</div>
                            <div class="d-table-head">Euclidean</div>
                            <div class="d-table-head">'Generic' Manifold</div>
                            <div class="d-table-head">Compact Manifold</div>
                        </div>
                        <div class="d-table-row fragment">
                            <div class="d-table-cell" data-id="FP">
                                Forward Process
                            </div>
                            <div class="d-table-cell">OU</div>
                            <div class="d-table-cell">Langevin
                                dynamics </div>
                            <div class="d-table-cell">Langevin dynamics</div>
                        </div>
                        <div class="d-table-row fragment">
                            <div class="d-table-cell">Base distribution</div>
                            <div class="d-table-cell">Gaussian</div>
                            <div class="d-table-cell" data-id="wrap">Wrapped normal</div>
                            <div class="d-table-cell" data-id="unif">Uniform</div>
                        </div>
                        <div class="d-table-row fragment">
                            <div class="d-table-cell" data-id="time">Time reversal</div>
                            <div class="d-table-cell">Cattiaux, 2021</div>
                            <div class="d-table-cell" data-id="thm-name">Theorem 3.5 or 3.6</div>
                            <div class="d-table-cell">Theorem 3.5 or 3.6</div>

                        </div>
                        <div class="d-table-row fragment">
                            <div class="d-table-cell">
                                <div class="r-hstack items-start justify-start">
                                    <div data-id="sde">SDE</div>&nbsp;
                                    <div data-id="disc">Discretis</div>ation
                                </div>
                            </div>
                            <div class="d-table-cell">Eular-Maruyama</div>
                            <div class="d-table-cell">
                                <div data-id="grw">GRW</div>
                            </div>
                            <div class="d-table-cell">
                                GRW
                            </div>
                        </div>
                        <div class="d-table-row fragment">
                            <div class="d-table-cell">
                                <div data-id="sm">Score-matching</div>
                            </div>
                            <div class="d-table-cell">
                                <div class="r-hstack">
                                    <div data-id="denoise">Denoising</div>/Implicit
                                </div>
                            </div>
                            <div class="d-table-cell" style="vertical-align: middle;">
                                <div class="r-hstack">
                                    <div data-id="denoise">Denoising</div>/Implicit
                                </div>
                            </div>
                            <div class="d-table-cell" style="vertical-align: middle;">
                                <div class="r-hstack">
                                    <div data-id="denoise">Denoising</div>/Implicit
                                </div>
                            </div>
                        </div>
                        <div class="d-table-row fragment">
                            <div class="d-table-cell"> Sample \(p_{t|0}(\m{X}_t|\m{X}_0)\)</div>
                            <div class="d-table-cell">Analytic</div>
                            <div class="d-table-cell" style="vertical-align: middle;">Discretise SDE
                            </div>
                            <div class="d-table-cell" style="vertical-align: middle;">Discretise SDE
                            </div>
                        </div>
                        <div class="d-table-row items-start justify-start fragment">
                            <div class="d-table-cell">\(\condscore\)</div>
                            <div class="d-table-cell">Analytic</div>
                            <div class="d-table-cell"><img style=" height: 0.8em;" class="my-0" data-id="None"
                                    src="figures/icons/cross.svg">
                                - Use ISM
                            </div>
                            <div class="d-table-cell" style="vertical-align: middle;">Strum-Louiville<br>& Varadhan
                                Approx.
                            </div>
                        </div>
                    </div>
            </section>

            <section data-auto-animate="" hidden="" aria-hidden="true" class="future" style="display: block;">
                <div class="r-hstack justify-start h5">
                    <h1 class="">
                        <div data-id="FP">Forward Process</div>
                    </h1>

                </div>
                <div class="r-vstack items-start">
                    <p class="mt-0 frgment">The typical forward SDE is in fact a specific form of <em>Langevin
                            dynamics</em></p>
                    <div class="w-100 r-hstack fragment mt-2"><span>\(\d \X = \langdrift \d t + \langnoise \brownian\)
                        </span><span class="fragment fade-right" style="transition: all 1.5s ease;">\(\quad
                            \xrightarrow[t\to \infty]{\text{converges
                            to}}\quad
                            p(\m{X}) \propto
                            e^{-U(\m{X})}\)</span></div>
                    <p class="fragment">Where you have \(U(\m{X}) = \norm{\m{X}}^2\), this gives a Gaussian</p>
                    <p class="fragment">As it turns out, Langevin dynamics still hold on most
                        manifolds</p>
                    <div class="w-100 r-hstack fragment mt-2"><span>\(\d \X = \langdrift \d t + \langnoise
                            \brownian^\c{M}\)
                        </span><span class="fragment fade-right animate-1-5">\(\quad
                            \xrightarrow[t\to \infty]{\text{converges
                            to}}\quad
                            \frac{\d p}{\d \operatorname{Vol}_\c{M}} (\m{X}) \propto e^{-U(\m{X})}\)</span></div>
                    <div class="columns w-100 mt-3">
                        <div class="column r-vstack items-center fragment fade-up" style="overflow: visible;">
                            <div class="caption mb-0 p-div small">Riemannian normal</div>
                            <img class="my-0 w-50" style="height: 190px; object-fit: cover; object-position: bottom;"
                                src="figures/manifold/sphere_riemannian_gaussian.png">
                            <div class="w-100 footnotesize">\(U(\m{X}) = d_\c{M}(\m{X}, \mu)^2\)</div>
                        </div>
                        <div class="column r-vstack items-center fragment fade-up" data-id="wrap">
                            <div class="caption mb-0 p-div small">Wrapped normal</div>
                            <img class="my-0 w-50" style="height: 190px; object-fit: cover; object-position: bottom;"
                                src="figures/manifold/sphere_riemannian_gaussian.png">
                            <div class="w-100 footnotesize">\(U(\m{X}) = d_\c{M}(\m{X}, \mu)^2 + \log|D
                                \exp_\mu^{-1}(\m{X})|\)
                            </div>
                        </div>
                        <div class="column r-vstack items-center fragment fade-up" data-id="unif">
                            <div class="caption mb-0 p-div small">
                                <div>Uniform</div>
                            </div>
                            <img class="my-0 w-50" style="height: 190px; object-fit: cover; object-position: bottom;"
                                src="figures/manifold/sphere_uniform.png">
                            <div class="w-100 footnotesize">\(U(\m{X}) = 0\)</div>
                        </div>
                    </div>
                </div>

            </section>

            <section data-auto-animate="" hidden="" aria-hidden="true" class="future" style="display: block;">
                <div class="r-hstack justify-start h5">
                    <h1>
                        <div data-id="approx-score">Approximating \(\nabla_{\m{X}_t}\log
                            p_{t|0}(\m{X}_t | \m{X}_0)
                            \)</div>
                    </h1>
                    <h1>&nbsp;</h1>
                    <h1 class="">
                        <div>on Manifolds</div>
                    </h1>

                </div>
                <div class="columns">
                    <div class="column">
                        <h5 class="fragment"><b>Strum-Louiville (compact only)</b></h5>
                        <p class="fragment">If we have the <em>eigenpairs</em> \((\lambda_j, \phi_j)\) of the
                            <em>Laplace-Beltrami
                                operator \( \Delta_\c{M}\)</em> then
                        </p>
                        <div class="w-100 fragment">
                            <div class="w-100">
                                \( p_{t|0}(\m{X}_t | \m{X}_0) =\)
                            </div>
                            <div class="w-100 mt-2">
                                \(\sum_{j\in\N} e^{-\lambda_i t} \phi_j(\m{X}_0) \phi_j(\m{X}_t) \)
                            </div>
                        </div>
                    </div>
                    <div class="column">
                        <h5 class="fragment"><b>Varadhan</b></h5>
                        <p class="fragment">Alternatively we have in the small time limit:</p>
                        <div class="w-100 fragment">

                            <div class="w-100">
                                \( \lim_{t\to 0} \nabla_{\m{X}_t}\log
                                p_{t|0}(\m{X}_t | \m{X}_0)\)
                            </div>
                            <div class="w-100 mt-2">
                                \( = \exp^{-1}(\m{X}_t, \m{X}_0) / t\)
                            </div>
                        </div>
                    </div>
                </div>
                <img class="img-fluid w-75 mt-5 fragment" src="figures/manifold/s2_heat_kernel_approximation.svg">
            </section>

            <section data-auto-animate="" hidden="" aria-hidden=" true" class="future" style="display: block;">
                <div class="r-hstack justify-start h5">
                    <h1>Score matching losses on manifolds
                    </h1>

                </div>
                <div class="r-stretch r-vstack items-center">

                    <table class="w-100 small">
                        <tr class="">
                            <th class="" style="border: 0 !important;">Loss</th>
                            <th class="" style="border: 0 !important;">Approximation</th>
                            <th class="" style="border: 0 !important;">Loss function</th>
                            <th class="" style="border: 0 !important;" colspan="2">Requirements</th>
                            <th class="" style="border: 0 !important;">Complexity</th>
                        </tr>
                        <tr class="midrule">
                            <th class=""></th>
                            <th class=""></th>
                            <th class=""></th>
                            <th class="">\(p_{t|0}\)</th>
                            <th class="">\( \exp^{-1} \)</th>
                            <th class=""></th>
                        </tr>
                        <tr>
                            <td rowspan="3" style="vertical-align: middle;">DSM</td>
                            <td>None</td>
                            <td>\(\E\sbr{\norm{\m{s}(\X ) - \nabla_{\m{X}_t}\log
                                p_{t|0}(\m{X}_t | \m{X}_0)}^2}\)</td>
                            <td>
                                <img style="height: 0.8em;" class="my-0 img-fluid" src="figures/icons/tick.svg">
                            </td>
                            <td>
                                <img style="height: 0.8em;" class="my-0 img-fluid" src="figures/icons/cross.svg">
                            </td>
                            <td>\(\c{O}(1)\)</td>
                        </tr>
                        <tr>
                            <td style="text-align: center;">Truncation</td>
                            <td>\(\E\sbr{\norm{\m{s}(\X ) - \nabla_{\m{X}_t}\log S_J(\m{X}_t, \m{X}_0)}^2}\)</td>
                            <td>Expansion</td>
                            <td>
                                <img style="height: 0.8em;" class="my-0 img-fluid" src="figures/icons/cross.svg">
                            </td>
                            <td>\(\c{O}(1)\)</td>
                        </tr>
                        <tr class="midrule">
                            <td style="text-align: center;">Varhardan</td>
                            <td>\(\E\sbr{\norm{\m{s}(\X ) - \exp_{\m{X}_t}^{-1}(\m{X}_s)/t}}\)</td>
                            <td>
                                <img style="height: 0.8em;" class="my-0 img-fluid" src="figures/icons/cross.svg">
                            </td>
                            <td>
                                <img style="height: 0.8em;" class="my-0 img-fluid" src="figures/icons/tick.svg">
                            </td>
                            <td>\(\c{O}(1)\)</td>
                        </tr>
                        <tr>
                            <td rowspan="2" style="vertical-align: middle;">ISM</td>
                            <td>Deterministic</td>
                            <td>\(\E\sbr{\norm{\m{s}(t, \m{X}_t)}^2 + 2 \operatorname{div}(t, \cdot)(\m{X}_t)}\)</td>
                            <td>
                                <img style="height: 0.8em;" class="my-0 img-fluid" src="figures/icons/cross.svg">
                            </td>
                            <td>
                                <img style="height: 0.8em;" class="my-0 img-fluid" src="figures/icons/cross.svg">
                            </td>
                            <td>\(\c{O}(d)\)</td>
                        </tr>
                        <tr>
                            <td style="text-align: center;">Stochastic</td>
                            <td>\(\E\sbr{\norm{\m{s}(t, \m{X}_t)}^2 + 2 \m{\varepsilon}^\top\operatorname{div}(t,
                                \cdot)(\m{X}_t)\m{\varepsilon}}\)</td>

                            <td>
                                <img style="height: 0.8em;" class="my-0 img-fluid" src="figures/icons/cross.svg">
                            </td>
                            <td>
                                <img style="height: 0.8em;" class="my-0 img-fluid" src="figures/icons/cross.svg">
                            </td>
                            <td>\(\c{O}(1)\)</td>
                        </tr>
                    </table>
                </div>
            </section>

            <section data-auto-animate="" hidden="" aria-hidden="true" class="future" style="display: block;">
                <div class="r-hstack justify-start h5">
                    <h1>Earth-Science Datasets</h1>
                </div>
                <div class="r-vstack w-100">

                    <div class="r-hstack w-100 items-center justify-around fragment">
                        <div class=" r-vstack" style="width: 20%">
                            <img class="img-fluid w-100 my-0" m src="figures/manifold/earth_science/volcano.png">
                            <div class="p-div caption mb=0 mt-2">Volcanoes</div>
                        </div>
                        <div class="r-vstack" style="width: 20%">
                            <img class="img-fluid w-100 my-0" m src="figures/manifold/earth_science/earthquake.png">
                            <div class="p-div caption mb=0 mt-2">Earthquakes</div>
                        </div>
                        <div class="r-vstack" style="width: 20%">
                            <img class="img-fluid w-100 my-0" m src="figures/manifold/earth_science/flood.png">
                            <div class="p-div caption mb=0 mt-2">Floods</div>
                        </div>
                        <div class="r-vstack" style="width: 20%">
                            <img class="img-fluid w-100 my-0" m src="figures/manifold/earth_science/fire.png">
                            <div class="p-div caption mb=0 mt-2">Fires</div>
                        </div>
                    </div>
                    <div class="d-table w-100 small fragment">
                        <div class=" d-table-row">
                            <div class="d-table-head">Method</div>
                            <div class="d-table-head">Volcanoes</div>
                            <div class="d-table-head">Earthquakes</div>
                            <div class="d-table-head">Floods</div>
                            <div class="d-table-head">Fires</div>
                        </div>
                        <div class="d-table-row">
                            <div class="d-table-cell">Riemannian CNF</div>
                            <div class="d-table-cell">$\mathbf{-6.05_{\pm 0.61}}$</div>
                            <div class="d-table-cell">${0.14_{\pm 0.23}}$</div>
                            <div class="d-table-cell">${1.11_{\pm 0.19}}$</div>
                            <div class="d-table-cell">$\mathbf{-0.80_{\pm 0.54}}$</div>
                        </div>
                        <div class="d-table-row">
                            <div class="d-table-cell">Moser Flow</div>
                            <div class="d-table-cell">${-4.21_{\pm 0.17}}$</div>
                            <div class="d-table-cell">$\mathbf{-0.16_{\pm 0.06}}$</div>
                            <div class="d-table-cell">$\mathbf{0.57_{\pm 0.10}}$</div>
                            <div class="d-table-cell">$\mathbf{-1.28_{\pm 0.05}}$</div>
                        </div>
                        <div class="d-table-row" style="background-color: #D4E6F1;">
                            <div class="d-table-cell">Sterorgraphic SGM</div>
                            <div class="d-table-cell">${-3.80_{\pm 0.27}}$</div>
                            <div class="d-table-cell">$\mathbf{-0.19_{\pm 0.05}}$</div>
                            <div class="d-table-cell">$\mathbf{0.59_{\pm 0.07}}$</div>
                            <div class="d-table-cell">$\mathbf{-1.28_{\pm 0.12}}$</div>
                        </div>
                        <div class="d-table-row d-table-bottom-border" style="background-color: #D4E6F1;">
                            <div class="d-table-cell">Riemannian SGM</div>
                            <div class="d-table-cell">${-4.92_{\pm 0.25}}$</div>
                            <div class="d-table-cell">$\mathbf{-0.19_{\pm 0.07}}$</div>
                            <div class="d-table-cell">$\mathbf{0.45_{\pm 0.17}}$</div>
                            <div class="d-table-cell">$\mathbf{-1.33_{\pm 0.06}}$</div>
                        </div>
                        <div class="d-table-row">
                            <div class="d-table-cell">Dataset Size</div>
                            <div class="d-table-cell">827</div>
                            <div class="d-table-cell">6120</div>
                            <div class="d-table-cell">4875</div>
                            <div class="d-table-cell">12809</div>
                        </div>
                    </div>
                </div>
            </section>

            <section data-auto-animate="" hidden="" aria-hidden="true" class="future" style="display: block;">
                <div class="r-hstack justify-start h5">
                    <h1>High-Dimension Tori</h1>
                </div>
                <p class="fragment mt-n4">Place a 2-mode mixture-of-Gaussian ditribution on \(\c{S}_1^n\).</p>
                <div class="r-vstack w-100 fragment">
                    <img class="img-fluid w-100" src="figures/manifold/high-dim.svg">
                </div>
                <p class="fragment">Other applications on Lie groups, and hyperbolic space</p>
            </section>

            <section data-auto-animate="" hidden="" aria-hidden="true" class="future" style="display: block;">
                <div class="r-stretch r-vstack items-center w-100">
                    <div class="r-vstack w-100">
                        <h1 class="h4" style="text-align: center;">Chapter 4: Score-based modelling on constrained
                            manifolds</h1>
                        <h1>
                            <div data-id="title">Based on <em>Diffusion models for constrained domains, TMLR 2023</em>
                            </div>
                        </h1>
                    </div>
                    <div class="r-hstack mt-4 w-75 items-start">
                        <div class="r-vstack mx-1" style="width: 16% !important;">
                            <img class="img-fluid face-circle" src="figures/faces/fishman.jpg" style="height">
                            <h5 class="footnotesize my-0">Nic<br>Fishman</h5>
                        </div>
                        <div class="r-vstack mx-1" style="width: 16% !important;">
                            <img class="img-fluid face-circle" src="figures/faces/klarner.jpg" style="height">
                            <h5 class="footnotesize my-0">Leo<br>Klarner</h5>
                        </div>
                        <div class="r-vstack mx-1" style="width: 16% !important;">
                            <img class="img-fluid face-circle" src="figures/faces/debortoli.jpg" style="height">
                            <h5 class="footnotesize my-0">Valentin<br>De Bortoli</h5>
                        </div>
                        <div class="r-vstack mx-1" style="width: 16% !important;">
                            <img class="img-fluid face-circle" src="figures/faces/mathieu2.jpg" style="height">
                            <h5 class="footnotesize my-0">Émile<br>Mathieu</h5>
                        </div>
                        <div class="r-vstack mx-1" style="width: 16% !important;">
                            <img class="img-fluid face-circle" src="figures/faces/hutchinson.jpg" style="height">
                            <h5 class="footnotesize my-0">Michael<br>Hutchinson</h5>
                        </div>

                    </div>
                    <div class="small" style="width: 85% !important; opacity: 80%;">
                        <p>Personal contributions: Project conception, practical methodology & code, some experiments,
                            project supervision.</p>
                    </div>
                </div>
            </section>

            <section data-auto-animate="" hidden="" aria-hidden="true" class="future" style="display: block;">
                <div class="r-hstack justify-start h5">
                    <h1>What problem are we trying to solve?</h1>
                </div>
                <div class="w-100 r-stretch r-vstack items-center justify-around mb-5 ">
                    <div class="r-hstack w-100">
                        <img src="figures/constrained/bondary_violation_sde.svg" class="w-25 fragment">
                        <div class="w-75 r-vstack">
                            <p class=" fragment">
                                If we have boundaries, the SDEs used in typical diffusion models are
                                guaranteed to explode outside the boundary.
                            </p>
                            <p class=" fragment">
                                If we want to guarantee our modelled density lies inside the boundary, we need a new
                                strategy.
                            </p>
                        </div>
                    </div>
                    <p class=" fragment">Solution: Modify the noising SDE used to resect the boundary</p>
                    <div class="w-100 columns items-center">
                        <div class="column items-center fragment">
                            <h5>Barrier SDEs</h5>
                            <p><em>Expand space near the boundary, so that it takes infinite time for the SDE to hit the
                                    edge</em></p>
                        </div>
                        <div class="column items-center fragment">
                            <h5>Reflected SDEs</h5>
                            <p><em>When the SDE hits the boundary, reflect it back inside the boundary</em></p>
                        </div>
                    </div>
                </div>
            </section>

            <section data-auto-animate="" hidden="" aria-hidden="true" class="future" style="display: block;">
                <div class="r-hstack justify-start h5">
                    <h1>Technical setting</h1>
                </div>
                <div class="w-100 r-stretch r-vstack items-center justify-around mb-5 ">
                    <p class="w-100">Given a Riemannian manifold $\c{N}$ and a series of constraints $\cbr{f_i: \c{N}
                        \to \R}_{i\in
                        I}$
                    </p>
                    <p>Define \(\c{M} = \cbr{x \in \c{N} \; : \; f_i(x) < 0 , \ i \in \mathcal{I}}\),</p>
                            <p class="w-100">and \( \partial \c{M} = \cbr{x \in \c{M} \; : \; f_i(x) = 0 \text{ for any
                                } i \in
                                \mathcal{I}
                                \text{
                                and } f_i(x) \not\geq 0 \text{ for any } i\in I}\)</p>
                            <img src="figures/constrained/polytope2.png" class="mt-3">
                </div>
            </section>


            <section data-auto-animate="" hidden="" aria-hidden="true" class="future" style="display: block;">
                <div class="r-hstack justify-start h5">
                    <h1>Method 1: Barrier SDEs</h1>
                </div>
                <div class="w-100 r-stretch r-vstack items-start justify-around mb-5 ">
                    <div class="w-100 r-hstack fragment">
                        <img src="figures/constrained/boundary_dists.svg" class="w-25">
                        <p class="w-75">For each boundary constraint \(f_i\), compute the distance to the boundary,
                            \(d(f_i, x)\).</p>
                    </div>
                    <div class="w-100 r-hstack fragment">
                        <img src="figures/constrained/boundary_phi.svg" class="w-25">
                        <p class="w-75">Produce a smooth barrier potential by computing \(\phi(x) = \sum_i -\log d(f_i,
                            x)\)</p>
                    </div>
                    <div class="w-100 r-hstack fragment">
                        <img src="figures/constrained/boundary_metric.svg" class="w-25">
                        <p class="w-75">Produce a Riemannian metric by computing \(g = \nabla^2\phi(x)\)</p>
                    </div>
                    <div class="w-100 r-hstack items-center fragment">
                        <p>\(\mathrm{d}
                            \v{X}_t = \tfrac{1}{2}
                            \mathrm{div}({g}^{-1})( \v{X}_t) \mathrm{d} t + {g}( \v{X}_t)^{-\frac{1}{2}} \mathrm{d}
                            \v{B}_t,
                            \)</p>
                        <div style="width: 50px"></div>
                        <p>\(\partial_t p_t = \tfrac{1}{2} \mathrm{Tr}({g}^{-1} \nabla^2p_t)\)</p>
                    </div>

                </div>
            </section>

            <section data-auto-animate="" hidden="" aria-hidden="true" class="future" style="display: block;">
                <div class="r-hstack justify-start h5">
                    <h1>Method 2: Reflected SDEs</h1>
                </div>
                <div class="w-100 r-stretch r-vstack items-start justify-around mb-5 ">
                    <div class="w-100 r-hstack">
                        <img src="figures/constrained/reflection_example.svg" class="w-25">
                        <div class="w-755 r-vstack">
                            <p class="w-100">When the SDE encounters a boundary, reflect the direction of travel back
                                inside the boundary.</p>
                            <p class="w-100 fragment">We use the formula \(\v{v}_{\text{reflect}} =
                                \v{v}_{\text{incident}} - 2
                                <\v{v}_{\text{incident}}, \v{n}>\v{n} \)
                            </p>
                        </div>
                    </div>

                    <p class="w-100 mb-0 fragment">This is formalised by a <em>Skorokhod
                            problem</em>, a pair of processes \((\bar{\v{B}}_t, \v{k}_t)\) where \(\v{k}_t\) keeps the
                        process inside the boundary via \[\bar{\v{B}}_t =
                        \bar{\v{B}}_0 + {\v{B}}_t - \v{k}_t \]</p>

                    <div class="w-100 fragment">
                        <p class="w-100 mb-0">Time-evolution of the process:</p>
                        <div class="w-100 r-hstack">
                            <div>\(\partial_t p_t(x) = \tfrac{1}{2} \Delta p_t(x),\)</div>
                            <div class="mx-3"></div>
                            <div>\(\partial_{ \v{n}} p_t(x_0) = 0\)</div>
                        </div>
                    </div>

                    <p class="mb-0 w-100 fragment">New time reversal result:</p>
                    <div class="w-100 r-hstack items-center fragment">
                        <p class="my-0">\(\d \v{X}_t^{\vsra} = \d\v{B}_t- \d \v{k}_t \)</p>
                        <p class="mx-4 my-0">\(\xrightarrow{\text{time reversal}}\)</p>
                        <p class="my-0">\(\mathrm{d} \v{X}_t^{\vsla{}} = \nabla \log p_{T-t}\del{\v{X}_t^{\vsla{}}}
                            \mathrm{d} t +
                            \mathrm{d}
                            \v{B}_t - \mathrm{d} \v{k}_t^{\vsla{}} \)</p>
                    </div>

                </div>
            </section>

            <section data-auto-animate="" hidden="" aria-hidden="true" class="future" style="display: block;">
                <div class="r-hstack justify-start h5">
                    <h1>Comparing the proposed SDEs</h1>
                </div>
                <div class="w-100 r-stretch r-vstack items-start justify-around mb-5">
                    <img src="figures/constrained/reflected_vs_brownian.svg" class="w-100">
                </div>
            </section>

            <section data-auto-animate="" hidden="" aria-hidden="true" class="future" style="display: block;">
                <div class="r-hstack justify-start h5">
                    <h1>Example application: Modelling cyclic peptides</h1>
                </div>
                <div class="w-100 r-stretch r-vstack items-start justify-around mb-5 ">
                    <div class="w-100  fragment">
                        <p class="w-100">Modelling protein chains is a key application of generative modelling.</p>
                        <div class="w-100 columns">
                            <div class="column">
                                <img src="figures/constrained/peptide_chain.svg" style="height: 150px">
                            </div>
                            <div class="column">
                                <img src="figures/constrained/ca_trace.svg" style="height: 150px">
                            </div>
                        </div>
                    </div>
                    <p class=" fragment">Cyclic peptides present a specific challenge, requiring that the chain form a
                        closed loop.</p>
                    <div class="w-100 columns">
                        <div class="column fragment">
                            <img src="figures/constrained/cyclic_peptide.svg" style="height:250px">
                        </div>
                        <div class="column fragment">
                            <p>Requiring the loop closes places constraints on the maximum distance between the anchor
                                point and other \(\alpha\) carbons.</p>
                        </div>
                        <div class="column fragment">
                            <img src="figures/constrained/hull.png" style="height: 250px;">
                        </div>
                    </div>
                </div>
            </section>
            <section data-auto-animate="" hidden="" aria-hidden="true" class="future" style="display: block;">
                <div class="r-hstack justify-start h5">
                    <h1>Example application: Modelling cyclic peptides</h1>
                </div>
                <div class="w-100 r-stretch r-vstack items-start justify-around mb-5 ">
                    <div class="w-100 columns">
                        <div class="column">
                            <img src="figures/constrained/loop_data_dist_2d.png">
                            <p>Data distribution of the set of cyclic peptides</p>
                        </div>
                        <div class="column">
                            <img src="figures/constrained/loop_logbarrier_dist_2d.png">
                            <p>Log barrier model. MMD \(0.032_{\pm 0.021}\)</p>
                        </div>
                        <div class="column">
                            <img src="figures/constrained/loop_reflected_dist_2d.png">
                            <p>Reflected model. MMD \(0.032_{\pm 0.001}\)</p>
                        </div>
                        <div class="column">
                            <img src="figures/constrained/loop_uniform_dist_2d.png">
                            <p>Uniform distribution. MMD \(0.112_{\pm 0.001}\)</p>
                        </div>
                    </div>
                    <p class="w-100 fragment">Other applications include robotic manipulation modelling and modelling of
                        densities on the hypercube (for images) and the simplex (for distributions)</p>
                </div>
            </section>

            <section data-auto-animate="" hidden="" aria-hidden="true" class="future" style="display: block;">
                <div class="r-stretch r-vstack items-center w-100">
                    <div class="r-vstack w-100">
                        <h1 class="h4" style="text-align: center;">Chapter 5: Efficient score-based modelling on
                            constrained manifolds</h1>
                        <h1>
                            <div data-id="title">Based on <em>Metropolis sampling for constrained diffusion models,
                                    Neurips
                                    2023</em>
                            </div>
                        </h1>
                    </div>
                    <div class="r-hstack mt-4 w-75 items-start">
                        <div class="r-vstack mx-1" style="width: 16% !important;">
                            <img class="img-fluid face-circle" src="figures/faces/fishman.jpg" style="height">
                            <h5 class="footnotesize my-0">Nic<br>Fishman</h5>
                        </div>
                        <div class="r-vstack mx-1" style="width: 16% !important;">
                            <img class="img-fluid face-circle" src="figures/faces/klarner.jpg" style="height">
                            <h5 class="footnotesize my-0">Leo<br>Klarner</h5>
                        </div>
                        <div class="r-vstack mx-1" style="width: 16% !important;">
                            <img class="img-fluid face-circle" src="figures/faces/mathieu2.jpg" style="height">
                            <h5 class="footnotesize my-0">Émile<br>Mathieu</h5>
                        </div>
                        <div class="r-vstack mx-1" style="width: 16% !important;">
                            <img class="img-fluid face-circle" src="figures/faces/hutchinson.jpg" style="height">
                            <h5 class="footnotesize my-0">Michael<br>Hutchinson</h5>
                        </div>
                        <div class="r-vstack mx-1" style="width: 16% !important;">
                            <img class="img-fluid face-circle" src="figures/faces/debortoli.jpg" style="height">
                            <h5 class="footnotesize my-0">Valentin<br>De Bortoli</h5>
                        </div>

                    </div>
                    <div class="small" style="width: 85% !important; opacity: 80%;">
                        <p>Personal contributions: Project conception, practical methodology & code, some
                            experiments, project supervision.</p>
                    </div>
                </div>
            </section>

            <section data-auto-animate="" hidden="" aria-hidden="true" class="future" style="display: block;">
                <div class="r-hstack justify-start h5">
                    <h1>What problem are we trying to solve?</h1>
                </div>
                <div class="w-100 r-stretch r-vstack items-center justify-around mb-5 ">
                    <p>Methods developed in the previous chapter and in parallel work have at least one of three main
                        drawbacks</p>
                    <ul>
                        <li class=" fragment">They warp the underlying geometry of the process</li>
                        <li class=" fragment">They can only handle restricted sets of constraints</li>
                        <li class=" fragment">They are slow to train due to slow noising rollouts</li>
                    </ul>
                    <table class="w-100 footnotesize mt-5 fragment">
                        <thead>
                            <tr>
                                <th style="width: 23%">Model</th>
                                <th style="width: 17%">Tractable conditional score</th>
                                <th style="width: 20%">Simulation-free forward sampling</th>
                                <th style="width: 25%">Modelling domain</th>
                                <th style="width: 15%">Preserves metric of \(\c{M}\)</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>Reflected Diffusions</td>
                                <td></td>
                                <td></td>
                                <td></td>
                                <td></td>
                            </tr>
                            <tr>
                                <td class="pl-5">Lou and Ermon, 2023</td>
                                <td> <img style="height: 0.8em;" class="my-0" src="figures/icons/tick.svg">
                                </td>
                                <td><img style="height: 0.8em;" class="my-0" src="figures/icons/tick.svg"></td>
                                <td>Convex \(\subset \R^d\)</td>
                                <td> <img style="height: 0.8em;" class="my-0" src="figures/icons/cross.svg">
                                </td>
                            </tr>
                            <tr>
                                <td class="pl-5">Chapter 4</td>
                                <td> <img style="height: 0.8em;" class="my-0" src="figures/icons/cross.svg">
                                </td>
                                <td>\(\c{O}(d)\)</td>
                                <td>Convex \(\subset\) any \(\c{M}\)</td>
                                <td><img style="height: 0.8em;" class="my-0" src="figures/icons/tick.svg"></td>
                            </tr>
                            <tr>
                                <td class="pl-5">This chapter</td>
                                <td> <img style="height: 0.8em;" class="my-0" src="figures/icons/cross.svg">
                                </td>
                                <td>\(\c{O}(d)\)</td>
                                <td>Convex \(\subset\) any \(\c{M}\)</td>
                                <td><img style="height: 0.8em;" class="my-0" src="figures/icons/tick.svg"></td>
                            </tr>
                            <tr>
                                <td>Barrier Diffusions</td>
                                <td></td>
                                <td></td>
                                <td></td>
                                <td></td>
                            </tr>
                            <tr>
                                <td class="pl-5">Chapter 4</td>
                                <td> <img style="height: 0.8em;" class="my-0" src="figures/icons/cross.svg">
                                </td>
                                <td> <img style="height: 0.8em;" class="my-0" src="figures/icons/cross.svg">
                                </td>
                                <td>Convex \(\subset\) any \(\c{M}\)</td>
                                <td> <img style="height: 0.8em;" class="my-0" src="figures/icons/cross.svg">
                                </td>
                            </tr>
                            <tr>
                                <td class="pl-5">Liu et. al., 2024 </td>
                                <td><img style="height: 0.8em;" class="my-0" src="figures/icons/tick.svg"></td>
                                <td><img style="height: 0.8em;" class="my-0" src="figures/icons/tick.svg"></td>
                                <td>Convex \(\subset \R^d\)</td>
                                <td> <img style="height: 0.8em;" class="my-0" src="figures/icons/cross.svg">
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </section>

            <section data-auto-animate="" hidden="" aria-hidden="true" class="future" style="display: block;">
                <div class="r-hstack justify-start h5">
                    <h1>Core idea</h1>
                </div>
                <div class="w-100 r-stretch r-vstack items-center justify-around mb-5 ">
                    <ul>
                        <li class=" fragment">The rollout of the reflect Brownian motion is slow</li>
                        <li class=" fragment">This is due to the expense of the reflection computation</li>
                        <li class=" fragment">We can <em>Metropilise</em> the reflection step</li>
                    </ul>
                    <div class="columns w-100">
                        <div class="column fragment"><img src="figures/better_constrained/accept_example.svg"
                                class="w-75">
                            <p class="my-0">If the unreflected step lies <em>inside</em> the boundary, accept the move
                            </p>
                        </div>
                        <div class="column fragment"><img src="figures/better_constrained/reject_example.svg"
                                class="w-75">
                            <p class="my-0">If the unreflected step lies <em>outside</em> the boundary, reject the move
                                and stay
                                still</p>
                        </div>
                    </div>
                </div>
            </section>

            <section data-auto-animate="" hidden="" aria-hidden="true" class="future" style="display: block;">
                <div class="r-hstack justify-start h5">
                    <h1>Huge reduction in implementation complexity</h1>
                </div>
                <div class="w-100 r-stretch r-vstack items-center justify-around mb-5 ">
                    <table class="w-100">
                        <thead>
                            <tr>
                                <th style="width: 40%">Sampling method</th>
                                <th style="width: 20%">Set indicator function</th>
                                <th style="width: 20%">Intersection operator</th>
                                <th style="width: 20%">Distance to boundary</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>Barrier method (Chapter 4)</td>
                                <td><img style="height: 0.8em;" class="my-0" src="figures/icons/tick.svg"></td>
                                <td><img style="height: 0.8em;" class="my-0" src="figures/icons/tick.svg"></td>
                                <td><img style="height: 0.8em;" class="my-0" src="figures/icons/tick.svg"></td>
                            </tr>
                            <tr>
                                <td>Mirror diffusion (Liu et. al. 2024)</td>
                                <td><img style="height: 0.8em;" class="my-0" src="figures/icons/tick.svg"></td>
                                <td><img style="height: 0.8em;" class="my-0" src="figures/icons/tick.svg"></td>
                                <td><img style="height: 0.8em;" class="my-0" src="figures/icons/tick.svg"></td>
                            </tr>
                            <tr>
                                <td>Reflection method (Chapter 4, Lou and Ermon, 2023)</td>
                                <td><img style="height: 0.8em;" class="my-0" src="figures/icons/tick.svg"></td>
                                <td><img style="height: 0.8em;" class="my-0" src="figures/icons/tick.svg"></td>
                                <td><img style="height: 0.8em;" class="my-0" src="figures/icons/cross.svg"></td>
                            </tr>
                            <tr>
                                <td>Projection sampler (Lou and Ermon, 2023)</td>
                                <td><img style="height: 0.8em;" class="my-0" src="figures/icons/tick.svg"></td>
                                <td><img style="height: 0.8em;" class="my-0" src="figures/icons/tick.svg"></td>
                                <td><img style="height: 0.8em;" class="my-0" src="figures/icons/cross.svg"></td>
                            </tr>
                            <tr>
                                <td>Metropolis sampler (This chapter)</td>
                                <td><img style="height: 0.8em;" class="my-0" src="figures/icons/tick.svg"></td>
                                <td><img style="height: 0.8em;" class="my-0" src="figures/icons/cross.svg"></td>
                                <td><img style="height: 0.8em;" class="my-0" src="figures/icons/cross.svg"></td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </section>

            <section data-auto-animate="" hidden="" aria-hidden="true" class="future" style="display: block;">
                <div class="r-hstack justify-start h5">
                    <h1>Core result: The Metropolis approximation converges to the reflected Brownian motion</h1>
                </div>
                <div class="w-100 r-stretch r-vstack items-center justify-around mb-5 ">
                    <div class="r-hstack w-100">
                        <table class="w-50 px-3">
                            <tr>
                                <th style="width:33%;">Reflection density</th>
                                <th style="width:33%;">Rejection density</th>
                                <th style="width:33%;">Metropolis density</th>
                            </tr>
                            <tr class=" fragment">
                                <td class="px-0">
                                    <img src="figures/better_constrained/reflection_density_1.0.svg" class="w-100">
                                </td>
                                <td class="px-0">
                                    <img src="figures/better_constrained/rejection_density_1.0.svg" class="w-100">
                                </td>
                                <td class="px-0">
                                    <img src="figures/better_constrained/metropolis_density_1.0.svg" class="w-100">
                                </td>
                            </tr>
                            <tr class=" fragment">
                                <td class="px-0">
                                    <img src="figures/better_constrained/reflection_density_0.5.svg" class="w-100">
                                </td>
                                <td class="px-0">
                                    <img src="figures/better_constrained/rejection_density_0.5.svg" class="w-100">
                                </td>
                                <td class="px-0">
                                    <img src="figures/better_constrained/metropolis_density_0.5.svg" class="w-100">
                                </td>
                            </tr>
                            <tr class=" fragment">
                                <td class="px-0">
                                    <img src="figures/better_constrained/reflection_density_0.2.svg" class="w-100">
                                </td>
                                <td class="px-0">
                                    <img src="figures/better_constrained/rejection_density_0.2.svg" class="w-100">
                                </td>
                                <td class="px-0">
                                    <img src="figures/better_constrained/metropolis_density_0.2.svg" class="w-100">
                                </td>
                            </tr>
                        </table>
                        <div class="w-50 px-3 fragment">
                            <p>Proof spirit:</p>
                            <ul>
                                <li>
                                    Define an auxiliary rejection process
                                </li>
                                <li>Show this converges to the reflected process</li>
                                <li>Show the Metropilis process converges to the rejection</li>
                            </ul>
                        </div>
                    </div>

                </div>
            </section>

            <section data-auto-animate="" hidden="" aria-hidden="true" class="future" style="display: block;">
                <div class="r-hstack justify-start h5">
                    <h1>Scaling of the sampler in high dimensions is lower-order than the standard reflection sampler
                    </h1>
                </div>
                <div class="w-100 r-stretch r-vstack items-center justify-around mb-5 ">
                    <img src="figures/better_constrained/scaling.svg" class="w-100">
                </div>
            </section>

            <section data-auto-animate="" hidden="" aria-hidden="true" class="future" style="display: block;">
                <div class="r-hstack justify-start h5">
                    <h1>Wildfire data modelling
                    </h1>
                </div>
                <div class="w-100 r-stretch r-vstack items-center justify-around mb-5 ">
                    <div class="columns w-100">
                        <div class="column">
                            <img src="figures/better_constrained/wildfire_data_dist.png">
                            <p class="w-100">Wildfire distribution in the continental US</p>
                        </div>
                        <div class="column items-center">
                            <img src="figures/better_constrained/wildfire_rejection_dist.png">
                            <p>Reflected Brownian motion diffusion model and the Metropolis
                                sampler</p>
                        </div>
                        <div class="column">
                            <img src="figures/better_constrained/wildfire_uniform_dist.png">
                            <p class="w-100">An example uniform distribution with the same number of data samples</p>
                        </div>
                    </div>
                    <p class="my-0 fragment">Modelling this data with all the other approaches was almost impossible due
                        to
                        either speed or
                        lack of analytic boundary operations.</p>
                </div>
            </section>


            <section data-auto-animate="" hidden="" aria-hidden="true" class="future" style="display: block;">
                <div class="r-stretch r-vstack items-center w-100">
                    <div class="r-vstack w-100">
                        <h1 class="h4" style="text-align: center;">Chapter 6: Score-based modelling on geometric
                            structures on Riemannian manifolds</h1>
                        <h1>
                            <div data-id="title">Based on <em>Geometric neural diffusion processes, Neurips 2023</em>
                            </div>
                        </h1>
                    </div>
                    <div class="r-hstack mt-4 w-75 items-start">
                        <div class="r-vstack mx-1" style="width: 16% !important;">
                            <img class="img-fluid face-circle" src="figures/faces/mathieu2.jpg" style="height">
                            <h5 class="footnotesize my-0">Émile<br>Mathieu*</h5>
                        </div>
                        <div class="r-vstack mx-1" style="width: 16% !important;">
                            <img class="img-fluid face-circle" src="figures/faces/dutordoir.jpg" style="height">
                            <h5 class="footnotesize my-0">Vincent<br>Dutordoir*</h5>
                        </div>
                        <div class="r-vstack mx-1" style="width: 16% !important;">
                            <img class="img-fluid face-circle" src="figures/faces/hutchinson.jpg" style="height">
                            <h5 class="footnotesize my-0">Michael<br>Hutchinson*</h5>
                        </div>
                        <div class="r-vstack mx-1" style="width: 16% !important;">
                            <img class="img-fluid face-circle" src="figures/faces/debortoli.jpg" style="height">
                            <h5 class="footnotesize my-0">Valentin<br>De Bortoli</h5>
                        </div>
                        <div class="r-vstack mx-1" style="width: 16% !important;">
                            <img class="img-fluid face-circle" src="figures/faces/teh.png" style="height">
                            <h5 class="footnotesize my-0">Yee Whye<br>Teh</h5>
                        </div>
                        <div class="r-vstack mx-1" style="width: 16% !important;">
                            <img class="img-fluid face-circle" src="figures/faces/turner.png" style="height">
                            <h5 class="footnotesize my-0">Rich<br>Turner</h5>
                        </div>
                    </div>
                    <div class="scriptsize mt-4 p-div" style="opacity: 50%;">*equal contribution</div>
                    <div class="small" style="width: 85% !important; opacity: 80%;">
                        <p>Personal contributions: Project conception, GNDP framework development, Langevin conditional
                            sampling method, some code & experiments, mathematical results regarding invariance and
                            equivalence.</p>
                    </div>
                </div>
            </section>

            <section data-auto-animate="" hidden="" aria-hidden="true" class="future" style="display: block;">
                <div class="r-hstack justify-start h5">
                    <h1>What problem are we trying to solve?
                    </h1>
                </div>
                <div class="w-100 r-stretch r-vstack items-center justify-around mb-5 ">
                    <p class=" fragment">Move from modelling distributions supported on <em>manifolds</em> to
                        distributions on
                        <em>geometric structures</em> on manifolds
                    </p>
                    <div class="w-100 r-hstack">
                        <div class="r-vstack items-center mx-5 fragment">
                            <img src="figures/geometric_structures/grw.png"
                                style="margin-bottom: -80px;margin-top: -100px;">
                            <p>Paths on manifolds</p>
                            <p>\(f: \R \to \c{M}\)</p>
                        </div>
                        <div class="r-vstack items-center mx-5 fragment">
                            <img src="figures/geometric_structures/s2_pr.png" style="width:400px">
                            <p>Tensor fields on manifolds</p>
                            <p class="my-0">\(f\in \Gamma\del{T_q^p \c{M}}\)</p>
                            <p class="my-0">\(\approx f: \c{m} \to \text{vector space}\)</p>
                        </div>
                    </div>
                </div>
            </section>

            <section data-auto-animate="" hidden="" aria-hidden="true" class="future" style="display: block;">
                <div class="r-hstack justify-start h5">
                    <h1>Modelling infinite dimension functions
                    </h1>
                </div>
                <div class="w-100 r-stretch r-vstack items-center justify-around mb-5 ">
                    <p class="w-100 fragment">We are trying to model functions \(f: \c{X} \to
                        \c{Y} \), living in some
                        function
                        space \(C(\c{X}, \c{Y})\)
                    </p>
                    <p class=" fragment">These are inherently infinite-dimension objects, which we can't represent in a
                        computer</p>
                    <p class="mt-0 fragment">&rarr; we will need to choose some method of discretisation</p>
                    <p class="w-100 fragment">We want to model a distribution \(\mu \in \c{P}\del{C(\c{X}, \c{Y})}\)</p>
                    <p class=" fragment">Strategy: model the distribution on all finite index sets \(\v{x} = (x_1, ...,
                        x_n)\)</p>
                    <div class="w-100 fragment">

                        <p class="w-100">Define a noising process on the marginals by </p>
                        <p class="mt-1">\[\d\v{Y}_t(\v{x}) =
                            \tfrac{1}{2}\beta_t \sbr{\v{m}\del{\v{x}} - \v{Y}_t(\v{x})}\d t + \sqrt{\beta_t}
                            \m{K}(\v{x},
                            \v{x})^\frac{1}{2} \d \v{B}_t\]</p>
                        <p class="w-100 mt-1">which converges to \(\c{N}\del{\v{m}\del{\v{x}},
                            \m{K}\del{\v{x}, \v{x}}}\), a Gaussian process</p>
                    </div>

                </div>
            </section>

            <section data-auto-animate="" hidden="" aria-hidden="true" class="future" style="display: block;">
                <div class="r-hstack justify-start h5">
                    <h1>Modelling considerations
                    </h1>
                </div>
                <div class="w-100 r-stretch r-vstack items-center justify-around mb-5 ">
                    <div class="w-100  fragment">
                        <p class="w-100">In this case the reverse process is given by </p>
                        <p class="mt-1">\[\d\v{Y}_t^{\vsla}(\v{x}) = \beta_t
                            \sbr{\tfrac{1}{2}\del{\v{m}\del{\v{x}} - \v{Y}_t^{\vsla}(\v{x})} + \m{K}(\v{x}, \v{x})
                            \nabla\log
                            p^{\v{x}}_{T-t}(\v{Y}_t^{\vsla}(\v{x}))}\d t + \sqrt{\beta_t} \m{K}(\v{x},
                            \v{x})^\frac{1}{2} \d
                            \v{B}_t\]</p>
                    </div>
                    <div class="w-100 fragment">

                        <p class="w-100">Given the score appears with a preconditioning term, we can make a choice about
                            how
                            to parametrise the score function.
                            Looking at the loss function:</p>
                        <p class="mt-1"> \[ \mathcal{L}(\theta; \Lambda(t)) = \mathbb{E} [\| \v{s}_\theta(t, \v{Y}_t) -
                            \nabla \log p_{t}({\v{Y}}_t|
                            \v{Y}_0)\|_{\Lambda(t)}^2 ] \\= \mathbb{E} [ \| \sigma_{t|0}\cdot (\v{Ks})_\theta(t,\v{Y}_t)
                            +
                            \v{K}(\v{x}, \v{x})^{1/2} \varepsilon \|_2^2 ] \]
                        </p>
                    </div>
                    <p class="w-100 mt-1 fragment">We found that learning \(\v{K}(\v{x}, \v{x}) \nabla \log p_t\) was
                        easiest.
                    </p>
                    <hr class="w-100 color fragment">
                    <p class="w-100 mb-0 fragment">
                        NB: This model does not learn a <em>proper</em> distribution over functions
                    </p>
                    <ul class=" fragment">
                        <li>To satisfy Kolmogorov <em>exchangeability</em> is easy, <em>consistency</em> is hard</li>
                        <li>Learning from data is often sufficient, and enforcing consistency makes learning tricky</li>
                    </ul>
                </div>
            </section>

            <section data-auto-animate="" hidden="" aria-hidden="true" class="future" style="display: block;">
                <div class="r-hstack justify-start h5">
                    <h1>Invariant stochastic processes
                    </h1>
                </div>
                <div class="w-100 r-stretch r-vstack items-center justify-around mb-5 ">
                    <img src="figures/geometric_structures/steerable_demo.svg" class="w-50">
                    <p class="w-100 fragment">Let us define the action of a group on a distribution on functions. For a
                        measurable set of functions \(F\) \[\sbr{g\cdot \mu}(\rm{F}) = \mu(g^{-1}\cdot \rm{F}) =
                        \mu\del{\cbr{g^{-1}\cdot f\; : \; f\in \rm{F}}}\]</p>
                    <p class="w-100 fragment">We call a measure invariant if \[
                        g\cdot \mu = \mu
                        \]</p>
                    <div class="w-100 r-vstack items-center fragment">

                        <p class="w-100">To model invariant functions, we need to enforce a condition on the score
                            function:
                        </p>
                        <p>
                            \(\mathbf{s}_\theta(t, g\cdot O) = \mathbf{s}_\theta(t, g\cdot x, \rho(g) {y}) = \rho(g)
                            \mathbf{s}_\theta(t, x, {y})\) for an
                            observation set \(O = (\v{x_o}, \v{y}_o)\)
                        </p>
                    </div>
                </div>
            </section>

            <section data-auto-animate="" hidden="" aria-hidden="true" class="future" style="display: block;">
                <div class="r-hstack justify-start h5">
                    <h1>Equivariant posterior maps
                    </h1>
                </div>
                <div class="w-100 r-stretch r-vstack items-center justify-around mb-5 ">
                    <div class="w-100 r-vstack items-center fragment">
                        <p class="w-100">Given an invariant distribution on functions, \(\mu\), how does the
                            <em>posterior
                                map</em> behave?
                        </p>
                        <p>\(P: C \to \mu(\cdot | C)\) for a context set \(C = (\v{x_c}, \v{y}_c)\)</p>
                    </div>
                    <div class="w-100 r-vstack items-center fragment">
                        <p class="w-100">Answer: It is <em>equivariant</em> in the sense that</p>
                        <p>\(P(g \cdot C) = g \cdot P(C) = g \cdot \mu(\cdot | C)
                            \) </p>
                    </div>
                    <div class="w-100 r-vstack items-center fragment">
                        <p class="w-100">It could also be termed <em>invariant</em>, as</p>
                        <p>\(\mu(g\cdot A | g \cdot \c{C}) = \mu( A | \c{C})\) for a measurable set \(A\)
                        </p>
                    </div>
                    <div class="w-100 r-vstack items-center fragment">
                        <p class="w-100">For amortised conditioning models, this implies another constraint on the score
                            function</p>

                        <p>\(\v{s}_\theta(t, g \cdot {O} | g \cdot{C}) = \rho(h) \v{s}_\theta(t, {O} | {C})\) for an
                            observation set \(O = (\v{x_o}, \v{y}_o)\)</p>
                    </div>
                </div>
            </section>

            <section data-auto-animate="" hidden="" aria-hidden="true" class="future" style="display: block;">
                <div class="r-hstack justify-start h5">
                    <h1>Equivariant posterior maps
                    </h1>
                </div>
                <div class="w-100 r-stretch r-vstack items-center justify-around mb-5 ">
                    <img src="figures/geometric_structures/conditional_ndp_rot.svg" class="w-100">
                </div>
            </section>

            <section data-auto-animate="" hidden="" aria-hidden="true" class="future" style="display: block;">
                <div class="r-hstack justify-start h5">
                    <h1>Langevin conditional sampling of diffusion models
                    </h1>
                </div>
                <div class="w-100 r-stretch r-vstack items-center justify-around mb-5 ">
                    <div class="w-100 r-vstack items-center fragment">

                        <p class="w-100">Core idea - exploit the following property of scores:</p>
                        <p> \[\nabla_{\v{x}^o} \log
                            p(\v{x}^o|\v{x}^c) = \nabla_{\v{x}^o} \log p([\v{x}^o, \v{x}^c]) - \nabla_{\v{x}^o} \log
                            p(\v{x}^c) = \nabla_{\v{x}^o} \log p(\v{x}).\]</p>
                    </div>
                    <div class="w-100 r-vstack items-center fragment">

                        <p class="w-100">Core procedure -iterate the following steps:</p>
                        <ul>
                            <li>Take a denoising step</li>
                            <li>Substitute a noised version of the known coordinates </li>
                            <li>Run a short Langevin correction to correct the substitution</li>
                        </ul>
                    </div>
                    <div class="w-100 r-vstack items-center fragment">

                        <p class="w-100">
                            This procedure
                        </p>
                        <ul>
                            <li>Avoids costly SMC approaches</li>
                            <li>Allows the model to see data it expects</li>
                            <li>Exactly samples the conditional distribution if the Langevin in the final step converges
                            </li>
                        </ul>
                    </div>
                </div>
            </section>

            <section data-auto-animate="" hidden="" aria-hidden="true" class="future" style="display: block;">
                <div class="r-hstack justify-start h5">
                    <h1>Langevin conditional sampling of diffusion models
                    </h1>
                </div>
                <div class="w-100 r-stretch r-vstack items-center justify-around mb-5 ">
                    <img src="figures/geometric_structures/compare_noising_schemes.svg" class="w-100">
                </div>
            </section>

            <section data-auto-animate="" hidden="" aria-hidden="true" class="future" style="display: block;">
                <div class="r-hstack justify-start h5">
                    <h1>Example application - Modelling Gaussian processes
                    </h1>
                </div>
                <div class="w-100 r-stretch r-vstack items-center justify-around mb-5 ">
                    <img src="figures/geometric_structures/plot_regression1d.svg" class="w-100">
                </div>
            </section>

            <section data-auto-animate="" hidden="" aria-hidden="true" class="future" style="display: block;">
                <div class="r-hstack justify-start h5">
                    <h1>Example application - Modelling hurricane paths
                    </h1>
                </div>
                <div class="w-100 r-stretch r-vstack items-center justify-around mb-5 ">
                    <div class="columns w-100">
                        <div class=" column">
                            <div class="w-100 r-vstack items-center">
                                <p class="mt-0 mb-2">Data</p>
                                <img src="figures/geometric_structures/data_samples.svg" class="w-100">
                            </div>
                        </div>
                        <div class="column">
                            <div class="w-100 r-vstack items-center">
                                <p class="mt-0 mb-2">Model</p>
                                <img src="figures/geometric_structures/model_samples.svg" class="w-100">
                            </div>
                        </div>
                    </div>
                    <div class="columns w-100 fragment">
                        <div class=" column">
                            <div class="w-100 r-vstack items-center">
                                <img src="figures/geometric_structures/interpolation_examples.svg" class="w-100">
                                <p class="mt-0 mb-2">Interpolation</p>
                            </div>
                        </div>
                        <div class="column">
                            <div class="w-100 r-vstack items-center">
                                <img src="figures/geometric_structures/extrapolation_examples.svg" class="w-100">
                                <p class="mt-0 mb-2">Extrapolation</p>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <section class="h-100" data-auto-animate="" style="display: block;">
                <div class="r-hstack justify-start h5">
                    <h1>Geometry & score-based modelling - A line of work</h1>
                </div>
                <article>
                    <div class="r-vstack w-100">
                        <div class="r-hstack w-100 items-start">
                            <div class="r-vstack w-25">
                                <!-- <img class="img-fluid w-75 mb-n3 mt-n4" src="figures/sphere_w_dist.png"> -->
                                <div class="w-75 mb-n3 mt-n4">
                                    <img class="column img-fluid my-0" src="figures/logos/rsgm.png" data-id="rsgm_pic">
                                </div>
                                <h2 class="my-0 small">
                                    <div data-id="title">Manifolds</div>
                                </h2>
                                <h3 class="my-0 footnotesize">
                                    <div data-id="conf">Neurips 2022</div>
                                </h3>
                            </div>
                            <div class="r-vstack w-25">
                            </div>
                            <div class="r-vstack w-25">
                                <img class="img-fluid" style="width: 65%"
                                    src="figures/logos/manifold_w_boundary_better.png">
                                <h2 class="my-0 small text-nowrap"><em>Better</em> Manifolds with Boundary</h2>
                                <h3 class="my-0 footnotesize">Neurips 2023</h3>
                            </div>
                            <div class="r-vstack w-25">
                            </div>
                        </div>
                        <img class="img-fluid w-100 mt-3 mb-1" style="max-width: 100% !important;"
                            src="figures/timeline.svg">
                        <div class="r-hstack w-100 items-start">
                            <div class="r-vstack w-25">
                            </div>
                            <div class="r-vstack w-25">
                                <img class="img-fluid" style="width: 65%" src="figures/logos/manifold_w_boundary.png"
                                    data-id="boundary_pic">
                                <h2 class="my-0 small text-nowrap">Manifolds with Boundary</h2>
                                <h3 class="my-0 footnotesize">TMLR 2023</h3>
                            </div>
                            <div class="r-vstack w-25">
                            </div>
                            <div class="r-vstack w-25">
                                <div class="r-hstack w-100">
                                    <img class="img-fluid w-50" src="figures/logos/geometric_ndp.png">
                                    <div class="mx-3" style="color: #002147;" data-id="amps">&</div>
                                    <img class="img-fluid w-50" src="figures/logos/field.svg">
                                </div>
                                <h2 class="my-0 small text-nowrap">Fields and Paths on Manifolds</h2>
                                <h3 class="my-0 footnotesize">Neurips 2023</h3>
                            </div>
                        </div>
                    </div>
                </article>
            </section>


            <section data-auto-animate="" hidden="" aria-hidden="true" class="future" style="display: block;">
                <div class="r-hstack justify-start h5">
                    <h1>Validation in Practise</h1>
                </div>
                <div class="w-100 columns" style="gap: 20px;
                ">
                    <div class="column">
                        <div class="fragment" data-fragment-index="1">
                            <h3 class="mt-0 mb-1">Protein Generation & Optimization</h3>
                            <div class="container">
                                <div class="citation">
                                    <p>Protein Structure and Sequence Generation with Equivariant Denoising Diffusion
                                        Probabilistic
                                        Models</p>
                                    <p>Namrata Anand, Tudor Achim</p>
                                    <p>Arxiv preprint 2022</p>
                                </div>
                                <div class="overlay fragment" data-fragment-index="5">
                                    <div class="r-vstack items-center justify-around h-100">
                                        <div class="r-hstack items-center justify-around w-100">
                                            <div class="fade-border">\( \del{\R^3 \times \textcolor{darkred}{\SU(2)}
                                                \times
                                                \c{C}_{20}
                                                \times \textcolor{darkred}{\SO(2)^4}}^n \)</div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="container">
                                <div class="citation">
                                    <p>Antigen-Specific Antibody Design and Optimization with Diffusion-Based Generative
                                        Models
                                        for
                                        Protein Structures.</p>
                                    <p>Shitong Luo, Yufeng Su, Xingang Peng, Sheng Wang, Jian Peng, Jianzhu Ma</p>
                                    <p>NeurIPS 2022</p>
                                </div>

                                <div class="overlay fragment" data-fragment-index="5">
                                    <div class="r-vstack items-center justify-around h-100">
                                        <div class="r-hstack items-center justify-around w-100">
                                            <div class="fade-border">\({\textcolor{darkred}{\SE(3)^n}} \times
                                                \c{C}_{20}\)</div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="container">
                                <div class="citation">
                                    <p>De novo design of protein structure and function with RFdiffusion</p>
                                    <!-- <p>Joseph L. Watson, David Juergens, Nathaniel R. Bennett, Brian L. Trippe, Jason Yim, Helen
                                E.
                                Eisenach, Woody Ahern, Andrew J. Borst, Robert J. Ragotte, Lukas F. Milles, Basile I. M.
                                Wicky,
                                Nikita Hanikel, Samuel J. Pellock, Alexis Courbet, William Sheffler, Jue Wang, Preetham
                                Venkatesh,
                                Isaac Sappington, Susana Vázquez Torres, Anna Lauko, Valentin De Bortoli, Emile Mathieu,
                                Sergey
                                Ovchinnikov, Regina Barzilay, Tommi S. Jaakkola, Frank DiMaio, Minkyung Baek & David
                                Baker</p> -->
                                    <p style="font-size: 30% !important;">Joseph L. Watson, David Juergens, Nathaniel R.
                                        Bennett, Brian L.
                                        Trippe, Jason Yim, Helen
                                        E.
                                        Eisenach, Woody Ahern, Andrew J. Borst, Robert J. Ragotte, Lukas F. Milles,
                                        Basile
                                        I. M.
                                        Wicky,
                                        Nikita Hanikel, Samuel J. Pellock, Alexis Courbet, William Sheffler, Jue Wang,
                                        Preetham
                                        Venkatesh,
                                        Isaac Sappington, Susana Vázquez Torres, Anna Lauko, Valentin De Bortoli, Emile
                                        Mathieu,
                                        Sergey
                                        Ovchinnikov, Regina Barzilay, Tommi S. Jaakkola, Frank DiMaio, Minkyung Baek &
                                        David
                                        Baker</p>
                                    <p>Nature volume 620, 2023</p>
                                </div>
                                <div class="overlay fragment" data-fragment-index="5">
                                    <div class="r-vstack items-center justify-around h-100">
                                        <div class="r-hstack items-center justify-around w-100">
                                            <div class="fade-border">\(\textcolor{darkred}{\SE(3)^n}\)</div>
                                        </div>
                                    </div>
                                </div>

                            </div>
                            <div class="container">
                                <div class="citation">
                                    <p>SE(3) diffusion model with application to protein backbone generation</p>
                                    <p>Jason Yim, Brian L. Trippe, Valentin De Bortoli, Emile Mathieu, Arnaud Doucet,
                                        Regina
                                        Barzilay,
                                        Tommi S. Jaakkola</p>
                                    <p>ICML 2023</p>
                                </div>

                                <div class="overlay fragment" data-fragment-index="5">
                                    <div class="r-vstack items-center justify-around h-100">
                                        <div class="r-hstack items-center justify-around w-100">
                                            <div class="fade-border">\(\textcolor{darkred}{\SE(3)^n}\)</div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="container">
                                <div class="citation">
                                    <p>Protein structure generation via folding diffusion.</p>
                                    <p>Kevin Eric Wu, Kevin K Yang, Rianne van den Berg, James Zou, Alex Xijie Lu, Ava P
                                        Amini
                                    </p>
                                    <p>ICLR 2023</p>
                                </div>

                                <div class="overlay fragment" data-fragment-index="5">
                                    <div class="r-vstack items-center justify-around h-100">
                                        <div class="r-hstack items-center justify-around w-100">
                                            <div class="fade-border">\(\textcolor{darkred}{\del{\SO(2)^6}^n}\)</div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                        </div>


                        <!-- <div class="citation">
                            <p>Denoising diffusion probabilistic models on so (3) for rotational alignment.</p>
                            <p>Adam Leach, Sebastian M Schmon, Matteo T Degiacomi, and Chris G Willcocks.</p>
                            <p>ICLR 2022 Workshop on Geometrical and Topological Representation Learning</p>
                        </div> -->



                    </div>
                    <div class="column">
                        <div class="fragment" data-fragment-index="2">
                            <h3 class="mt-0 mb-1">Protein Docking</h3>
                            <div class="container">

                                <div class="citation">
                                    <p>DiffDock: Diffusion Steps, Twists, and Turns for Molecular Docking</p>
                                    <p>Gabriele Corso, Hannes Stärk, Bowen Jing, Regina Barzilay, Tommi S. Jaakkola</p>
                                    <p>NeurIPS 2022 AI for Science, 2022</p>
                                </div>

                                <div class="overlay fragment" data-fragment-index="5">
                                    <div class="r-vstack items-center justify-around h-100">
                                        <div class="r-hstack items-center justify-around w-100">
                                            <div class="fade-border">\(\textcolor{darkred}{\SE(3)\times \SO(2)^n}\)
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="container">
                                <div class="citation">
                                    <p>DiffDock-PP: Rigid Protein-Protein Docking with Diffusion Models</p>
                                    <p>Mohamed Amine Ketata, Cedrik Laue, Ruslan Mammadov, Hannes Stark, Menghua Wu,
                                        Gabriele
                                        Corso,
                                        Céline Marquet, Regina Barzilay, Tommi S. Jaakkola</p>
                                    <p>ICLR 2023</p>
                                </div>


                                <div class="overlay fragment" data-fragment-index="5">
                                    <div class="r-vstack items-center justify-around h-100">
                                        <div class="r-hstack items-center justify-around w-100">
                                            <div class="fade-border">\(\textcolor{darkred}{\SE(3)}\)</div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="fragment" data-fragment-index="3">
                            <h3 class="mt-0 mb-1">Small Molecules</h3>

                            <div class="container">
                                <div class="citation">
                                    <p>Hyperbolic Graph Diffusion Model for Molecule Generation</p>
                                    <p>L Wen, X Wei</p>
                                    <p>Arxiv preprint, 2023</p>
                                </div>
                                <div class="overlay fragment" data-fragment-index="5">
                                    <div class="r-vstack items-center justify-around h-100">
                                        <div class="r-hstack items-center justify-around w-100">
                                            <div class="fade-border">\(\textcolor{darkred}{\mathbb{H}^2}\)</div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="container">
                                <div class="citation">
                                    <p>Torsional Diffusion for Molecular Conformer Generation</p>
                                    <p>Bowen Jing, Gabriele Corso, Jeffrey Chang, Regina Barzilay, Tommi Jaakkola</p>
                                    <p>NeurIPS 2022</p>
                                </div>
                                <div class="overlay fragment" data-fragment-index="5">
                                    <div class="r-vstack items-center justify-around h-100">
                                        <div class="r-hstack items-center justify-around w-100">
                                            <div class="fade-border">\(\textcolor{darkred}{\SO(2)^n}\)</div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="fragment" data-fragment-index="4">
                            <h3 class="mt-0 mb-1">Crystal Structures</h3>

                            <div class="container">
                                <div class="citation">
                                    <p>Crystal Structure Prediction by Joint Equivariant Diffusion on Lattices and
                                        Fractional
                                        Coordinates</p>
                                    <p>Rui Jiao, Wenbing Huang, Peijia Lin, Jiaqi Han, Pin Chen, Yutong Lu, Yang Liu</p>
                                    <p>ml4materials-iclr2023 Oral</p>
                                </div>
                                <div class="overlay fragment" data-fragment-index="5">
                                    <div class="r-vstack items-center justify-around h-100">
                                        <div class="r-hstack items-center justify-around w-100">
                                            <div class="fade-border">\(\textcolor{darkred}{\del{\c{S}_1^3}^n}\)</div>
                                        </div>
                                    </div>
                                </div>

                            </div>
                        </div>
                    </div>
                </div>
                <!-- 
                <p>This approch has been validated on bigger modelling tasks on e.g. proteins,
                    molecules etc,
                    see
                    <em>SE (3) diffusion model with application to protein backbone generation</em> or <em>Toroidal
                        Diffusion.</em>
                </p> -->
            </section>

            <section data-auto-animate="" hidden="" aria-hidden="true" class="future" style="display: block;">
                <div class="r-vstack w-100">
                    <div class="r-hstack justify-start h5 w-100">
                        <h1>Key Takeaways & My Contributions</h1>
                    </div>
                    <div class="r-vstack r-stretch w-100 justify-around">
                        <div class="r-vstack w-100 fragment">
                            <h1 class="h5  mb-1">What did we achive?</h1>
                            <ul class="" style="list-style-type: '&#9989 ';">
                                <li class="">Extentsion of a powerful genereative
                                    modelling
                                    framework to:
                                    <ul>
                                        <li>Generic manifolds</li>
                                        <li>Constrainted modelling scenarios</li>
                                        <li>A wide variety of signals on manifolds</li>
                                    </ul>
                                </li>
                                <li class="">State of the art results on common benchamrks and synthetic tasks.
                                </li>
                                <li class="">Properly <em>scalable</em> generative models.</li>
                                </li>
                                <li class="">Demonstrated <em>practical utility</em> on real tasks works.
                                </li>
                            </ul>
                        </div>
                        <div class="r-vstack w-100 fragment">
                            <h1 class="h5  mb-0">What did I contribute?</h1>
                            <ul class="mt-0">
                                <li class="">Project leadership</li>
                                <li class="">Large amounts of code and experimentation
                                </li>
                                <li class="">Some mathematical results</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </section>

            <section class="h-100" data-auto-animate="" style="display: block;" data-fragment="-1">
                <div class="h-100 r-vstack items-center justify-around">
                    <h1 class=" h1">
                        <div>Thanks for listening!</div>
                    </h1>
                </div>
            </section>
            <section class="h-100" data-auto-animate="" style="display: block;" data-fragment="-1">
                <div class="h-100 r-vstack items-center justify-start">
                    <h1 class="h1 mb-1">
                        <div>Thanks for listening!</div>
                    </h1>
                    <div class="r-hstack items-center w-100 mb-0">
                        <h3 class="my-0 text-small-caps"><a href="https://mjhutchinson.info">mjhutchinson.info</a>
                        </h3>
                        <div style="width: 5%"></div>
                        <h3 class="my-0 text-small-caps"><a href="https://twitter.com/MHutchinson141"><span
                                    class="twitter"></span>@mhutchinson141</a></h3>
                    </div>
                    <div style="height: 50px;"></div>
                    <div class="r-stretch columns w-75">
                        <div class="column">

                            <p class="my-3 footnotesize" data-fragment-index="0">
                                Riemannian
                                Score-Based Generative Modelling.<br>V. D. Bortoli*, E. Mathieu*, M.
                                Hutchinson*, J.
                                Thornton, Y. W. Teh, A.
                                Doucet.
                                <em>Neurips</em>, 2022.
                            </p>
                            <p class="my-3 footnotesize" data-fragment-index="0">
                                Diffusion Models
                                for
                                Constrained Domains.<br>N. Fishman, L. Klarner, V. D. Bortoli, E. Mathieu, M.
                                Hutchinson.
                                <em>TMLR</em>, 2023.
                            </p>
                            <p class="my-3 footnotesize" data-fragment-index="0">
                                Metropolis Sampling
                                for
                                Constrained Diffusion Models
                                .<br>N. Fishman, L. Klarner, E. Mathieu, M. Hutchinson, V. D. Bortoli.
                                <em>Neurips</em>, 2023.
                            </p>
                            <p class="mt-3 mb-0 footnotesize" data-fragment-index="0">
                                Geometric Neural Diffusion Processes.<br>E. Mathieu*, V. Dutordoir*, M.
                                Hutchinson*,
                                V.
                                D.
                                Bortoli, Y. W. Teh, R. Turner.

                                <em>Neurips</em>, 2023.
                            </p>
                        </div>
                        <!-- <div class="column"></div> -->
                    </div>
                    <div style="height: 50px;"></div>
                    <div class="w-100"><img src="figures/logos/oxweb-logo-rect.svg"></div>
                </div>
            </section>

            <section data-auto-animate="" hidden="" aria-hidden="true" class="future" style="display: block;">
                <div class="r-hstack justify-start h5">
                    <!-- <h1 class="dull">Geometry</h1>
                    <h1>&nbsp;</h1>
                    <h1 class="dull">in</h1>
                    <h1>&nbsp;</h1> -->
                    <h1 class="">Score-Based</h1>
                    <h1>&nbsp;</h1>
                    <h1 class="">Generative
                        Modelling</h1>
                </div>
                <p class="mb-0">How do score-based generative models work?</p>
                <div class="r-vstack r-stretch items-center">
                    <table style='border-collapse: collapse; border-spacing: 0; margin: 0; padding: 0;'>
                        <tr class="no-border fragment fade-in">
                            <td class="no-border" style="vertical-align: middle;">
                                <p style="vertical-align: middle;">A forward process...</p>
                            </td>
                            <td class="no-border">
                                <img class="my-0" src="figures/manifold/perturb_vp.gif">
                            </td>
                        </tr>
                        <tr class="no-border fragment fade-in">
                            <td class=" no-border" style="vertical-align: middle;">
                                <p>...which we then reverse</p>
                            </td>
                            <td class="no-border" style="vertical-align: middle;">
                                <img class="my-0" src="figures/manifold/denoise_vp.gif">
                            </td>
                        </tr>
                        <tr>
                            <td colspan="2">
                                <div class="w-100 scriptsize" style="opacity: 50%;">
                                    GIFs reproduced from <a
                                        href="https://yang-song.net/blog/2021/score/">https://yang-song.net/blog/2021/score/</a>
                                </div>
                            </td>
                        </tr>
                    </table>
                </div>
            </section>


            <section data-auto-animate="" hidden="" aria-hidden="true" class="future" style="display: block;">
                <div class="r-hstack justify-start h5 mb-0">
                    <!-- <h1 class="dull">Geometry</h1>
                    <h1>&nbsp;</h1>
                    <h1 class="dull">in</h1>
                    <h1>&nbsp;</h1> -->
                    <h1 class="">Score-Based</h1>
                    <h1>&nbsp;</h1>
                    <h1 class="">Generative
                        Modelling</h1>
                </div>
                <div class="r-vstack r-stretch items-start">
                    <p class="fragment">The forward noising process is a <em>Stochastic differential equation
                            (SDE)</em></p>
                    <div class="w-100 fragment">\(\d\X = \drift\d t + \noise \brownian \)
                    </div>
                    <p class="fragment">Typical
                        score matching uses the <em>Ornstein-Uhlenbeck</em> process:</p>
                    <div class="w-100 r-hstack fragment"><span>\( \d\X = -\textcolor{blue}{\X}\d t + \langnoise
                            \brownian \)
                        </span><span class="fragment fade-right" style="transition: all 1.5s ease;">\(\quad
                            \xrightarrow[t\to \infty]{\text{converges
                            to}}\quad
                            \c{N}(0, \operatorname{Id})\)</span></div>
                    <p class="fragment">The reverse can be proved to be defined by:</p>
                    <div class="w-100 fragment">
                        \( \d \Y = \sbr{\driftrev + \noiserev^2 \scorerev}\d t + \noiserev \brownian \)
                    </div>
                    <p class="mb-0 fragment">Where \( p_t(\m{X})\) is the evolved density of the SDE at time \(t\).</p>
                    <div class="r-hstack p-div fragment fade-right" style="transition: all 1.5s ease;">
                        \(\longrightarrow\)&nbsp;our deep learning challenge
                        is&nbsp;<em>learning the
                            score</em>,&nbsp;<div>\(\score\)</div>
                        .
                    </div>
                    </p>
                </div>
            </section>

            <section data-auto-animate="" hidden="" aria-hidden="true" class="future" style="display: block;">
                <div class="r-hstack justify-start h5">
                    <h1>
                        <div>Learning the score</div>
                    </h1>
                </div>
                <div class="r-vstack w-100 items-start">
                    <div class="w-100" data-id="dsm">\(\score= \underset{\m{s} \in
                        L^2}{\operatorname{argmin}}\;
                        \E_{\m{X}_0 \sim p_0}\E_{\m{X}_t | \m{X}_0 \sim p_{t|0}} \sbr{\norm{\m{s}(t, \m{X}_t) -
                        \nabla_{\m{X}} \log
                        p_{t|0}(\m{X}_t | \m{X}_0)}^2} \)
                    </div>
                    <p class="fragment">Why is this useful?</p>
                    <ul>
                        <li class="fragment">\(p_0\) is our data distribution - easy, fast to sample.</li>
                        <li class="fragment">\(p_{t|0}\) is analytic for the OU process - easy, fast to sample.</li>
                        <li class="fragment">A regression objective at time \(t\) only - no backprop through time
                            needed.</li>
                    </ul>
                    <p class="fragment">Now we just integrate over the time variable with some weighting
                        \(\textcolor{red}{\lambda(t)}\)
                    </p>
                    <div class="w-100 mt-3 fragment">\[\score = \underset{\m{s} \in
                        L^2}{\operatorname{argmin}}\; \int \textcolor{red}{\lambda(t)}
                        \E_{\m{X}_0 \sim p_0}\E_{\m{X}_t | \m{X}_0 \sim p_{t|0}} \sbr{\norm{\m{s}(t, \m{X}_t) -
                        \nabla_{\m{X}} \log
                        p_t(\m{X}_t | \m{X}_0)}^2} \d t \]
                    </div>
                    <p class="fragment">N.B. This objective is <em>high variance</em>, and requires us to take a
                        running
                        average of the
                        parameters at test time.</p>
            </section>

            <!-- <section data-auto-animate="" hidden="" aria-hidden="true" class="future" style="display: block;">
                <div class="r-hstack justify-start h5">
                    <h1>
                        The ODE connection
                    </h1>
                </div>
                <p>Given an SDE of the form</p>
                <div class="w-100">\(\d \X = \drift \d t + \noise \brownian \)</div>
                <p class="fragment">The following ODE has the same time-marginals</p>
                <div class="w-100 fragment">
                    <div class="w-100">\(\d \X = \sbr{\drift - \frac{1}{2}\noise^2 \score }\d t \)</div>
                </div>
                <p class="fragment">With this ODE we can:</p>
                <ul>
                    <li class="fragment">Use <em>error-tolerant</em> ODE solvers.</li>
                    <li class="fragment">Apply the same methods as <em>Continuous Normalising Flows</em> to get a
                        <em>change in
                            likelihood</em> for the flow, and therefore for the datapoint.
                    </li>
                </ul>
            </section> -->

            <section data-auto-animate="" hidden="" aria-hidden="true" class="future" style="display: block;">
                <div class="r-hstack justify-start h5">
                    <h1 class="dull">Geometry</h1>
                    <h1>&nbsp;</h1>
                    <h1 class="dull">in</h1>
                    <h1>&nbsp;</h1>
                    <h1 class="">Score-Based</h1>
                    <h1>&nbsp;</h1>
                    <h1 class="">Generative
                        Modelling</h1>
                </div>
                <p class="mb-0">How do score-based generative models work?</p>
                <div class="r-vstack r-stretch items-center">
                    <table style='border-collapse: collapse; border-spacing: 0; margin: 0; padding: 0;'>
                        <tr class="no-border">
                            <td class="no-border" style="vertical-align: middle;">
                                <p style="vertical-align: middle;">A forward process...</p>
                                <ul>
                                    <li>Defined by an SDE</li>
                                    <li>that converges nicely</li>
                                    <li>with an analytic reversal</li>
                                </ul>
                            </td>
                            <td class="no-border">
                                <img class="my-0" src="figures/manifold/perturb_vp.gif">
                            </td>
                        </tr>
                        <tr class="no-border">
                            <td class=" no-border" style="vertical-align: middle;">
                                <p>...which we then reverse</p>
                                <ul>
                                    <li>By learning the score</li>
                                    <li>and solving the SDE</li>
                                    <li>(or solving the ODE).</li>
                                </ul>
                            </td>
                            <td class="no-border" style="vertical-align: middle;">
                                <img class="my-0" src="figures/manifold/denoise_vp.gif">
                            </td>
                        </tr>
                        <tr>
                            <td colspan="2">
                                <div class="w-100 scriptsize" style="opacity: 50%;">
                                    GIFs reproduced from <a
                                        href="https://yang-song.net/blog/2021/score/">https://yang-song.net/blog/2021/score/</a>
                                </div>
                            </td>
                        </tr>
                    </table>
                </div>
            </section>

            <section data-auto-animate="" hidden="" aria-hidden="true" class="future" style="display: block;">
                <div class="r-stretch r-vstack w-100 items-center">
                    <div class="w-100 d-table">
                        <div class="d-table-row">
                            <div class="d-table-head">Ingredient \ Space</div>
                            <div class="d-table-head">Euclidean</div>
                            <div class="d-table-head fragment" data-fragment-index="1">'Generic' Manifold</div>
                            <div class="d-table-head fragment" data-fragment-index="2">Compact Manifold</div>
                        </div>
                        <div class="d-table-row">
                            <div class="d-table-cell" data-id="FP">
                                Forward Process
                            </div>
                            <div class="d-table-cell">OU</div>
                            <div class="d-table-cell fragment" data-fragment-index="1" style=" vertical-align: middle;">
                                <img style="height: 0.8em;" class="my-0" src="figures/icons/cross.svg">
                            </div>
                            <div class="d-table-cell fragment" data-fragment-index="2" style=" vertical-align: middle;">
                                <img style="height: 0.8em;" class="my-0" src="figures/icons/cross.svg">
                            </div>
                        </div>
                        <div class="d-table-row">
                            <div class="d-table-cell">Base distribution</div>
                            <div class="d-table-cell">Gaussian</div>
                            <div class="d-table-cell  fragment" data-fragment-index="1" style="vertical-align: middle;">
                                <img style="height: 0.8em;" class="my-0" src="figures/icons/cross.svg">
                            </div>
                            <div class="d-table-cell  fragment" data-fragment-index="2" style="vertical-align: middle;">
                                <img style="height: 0.8em;" class="my-0" src="figures/icons/cross.svg">
                            </div>
                        </div>
                        <div class="d-table-row">
                            <div class="d-table-cell">Time reversal</div>
                            <div class="d-table-cell">Cattiaux, 2021</div>
                            <div class="d-table-cell  fragment" data-fragment-index="1" style="vertical-align: middle;">
                                <img style="height: 0.8em;" class="my-0" src="figures/icons/cross.svg">
                            </div>
                            <div class="d-table-cell  fragment" data-fragment-index="2" style="vertical-align: middle;">
                                <img style="height: 0.8em;" class="my-0" src="figures/icons/cross.svg">
                            </div>
                        </div>
                        <div class="d-table-row">
                            <div class="d-table-cell">SDE Discretisation</div>
                            <div class="d-table-cell">Eular-Maruyama</div>
                            <div class="d-table-cell fragment" data-fragment-index="1" style="vertical-align: middle;">
                                <img style="height: 0.8em;" class="my-0" src="figures/icons/cross.svg">
                            </div>
                            <div class="d-table-cell fragment" data-fragment-index="2" style="vertical-align: middle;">
                                <img style="height: 0.8em;" class="my-0" src="figures/icons/cross.svg">
                            </div>
                        </div>
                        <div class="d-table-row">
                            <div class="d-table-cell">Score-matching</div>
                            <div class="d-table-cell">Denoising</div>
                            <div class="d-table-cell fragment" data-fragment-index="1" style="vertical-align: middle;">
                                <img style="height: 0.8em;" class="my-0" src="figures/icons/cross.svg">
                            </div>
                            <div class="d-table-cell fragment" data-fragment-index="2" style="vertical-align: middle;">
                                <img style="height: 0.8em;" class="my-0" src="figures/icons/cross.svg">
                            </div>
                        </div>
                        <div class="d-table-row">
                            <div class="d-table-cell"> Sample \(p_{t|0}(\m{X}_t|\m{X}_0)\)</div>
                            <div class="d-table-cell">Analytic</div>
                            <div class="d-table-cell fragment" data-fragment-index="1" style="vertical-align: middle;">
                                <img style="height: 0.8em;" class="my-0" src="figures/icons/cross.svg">
                            </div>
                            <div class="d-table-cell fragment" data-fragment-index="2" style="vertical-align: middle;">
                                <img style="height: 0.8em;" class="my-0" src="figures/icons/cross.svg">
                            </div>
                        </div>
                        <div class="d-table-row">
                            <div class="d-table-cell">\(\condscore\)</div>
                            <div class="d-table-cell">Analytic</div>
                            <div class="d-table-cell fragment" data-fragment-index="1" style="vertical-align: middle;">
                                <img style="height: 0.8em;" class="my-0" src="figures/icons/cross.svg">
                            </div>
                            <div class="d-table-cell fragment" data-fragment-index="2" style="vertical-align: middle;">
                                <img style="height: 0.8em;" class="my-0" src="figures/icons/cross.svg">
                            </div>
                        </div>
                    </div>
            </section>


            <section data-auto-animate="" hidden="" aria-hidden="true" class="future" style="display: block;">
                <div class="r-hstack justify-start h5">
                    <h1 class="">
                        <div data-id="FP">Forward Process</div>
                    </h1>

                </div>
                <div class="r-vstack items-start">
                    <p class="mt-0 frgment">The typical forward SDE is in fact a specific form of <em>Langevin
                            dynamics</em></p>
                    <div class="w-100 r-hstack fragment"><span>\(\d \X = \langdrift \d t + \langnoise \brownian\)
                        </span><span class="fragment fade-right" style="transition: all 1.5s ease;">\(\quad
                            \xrightarrow[t\to \infty]{\text{converges
                            to}}\quad
                            p(\m{X}) \propto
                            e^{-U(\m{X})}\)</span></div>
                    <p class="fragment">Where you have \(U(\m{X}) = \norm{\m{X}}^2\), this gives a Gaussian</p>
                    <p class="fragment mt-5">As it turns out, Langevin dynamics still hold on most
                        manifolds</p>
                    <div class="w-100 r-hstack fragment"><span>\(\d \X = \langdrift \d t + \langnoise \brownian^\c{M}\)
                        </span><span class="fragment fade-right animate-1-5">\(\quad
                            \xrightarrow[t\to \infty]{\text{converges
                            to}}\quad
                            \frac{\d p}{\d \operatorname{Vol}_\c{M}} (\m{X}) \propto e^{-U(\m{X})}\)</span></div>
                    <div class="columns w-100 mt-3">
                        <div class="column r-vstack items-center fragment fade-up" style="overflow: visible;">
                            <div class="caption mb-0 p-div small">Riemannian normal</div>
                            <img class="my-0 w-50" style="height: 190px; object-fit: cover; object-position: bottom;"
                                src="figures/sphere_riemannian_gaussian.png">
                            <div class="w-100 footnotesize">\(U(\m{X}) = d_\c{M}(\m{X}, \mu)^2\)</div>
                        </div>
                        <div class="column r-vstack items-center fragment fade-up" data-id="wrap">
                            <div class="caption mb-0 p-div small">Wrapped normal</div>
                            <img class="my-0 w-50" style="height: 190px; object-fit: cover; object-position: bottom;"
                                src="figures/sphere_riemannian_gaussian.png">
                            <div class="w-100 footnotesize">\(U(\m{X}) = d_\c{M}(\m{X}, \mu)^2 + \log|D
                                \exp_\mu^{-1}(\m{X})|\)
                            </div>
                        </div>
                        <div class="column r-vstack items-center fragment fade-up" data-id="unif">
                            <div class="caption mb-0 p-div small">
                                <div>Uniform</div>
                            </div>
                            <img class="my-0 w-50" style="height: 190px; object-fit: cover; object-position: bottom;"
                                src="figures/sphere_uniform.png">
                            <div class="w-100 footnotesize">\(U(\m{X}) = 0\)</div>
                        </div>
                    </div>
                </div>

            </section>

            <section data-auto-animate="" hidden="" aria-hidden="true" class="future" style="display: block;">
                <div class="r-hstack justify-start h5">
                    <h1 class="">Geometry</h1>
                    <h1>&nbsp;</h1>
                    <h1 class="">in</h1>
                    <h1>&nbsp;</h1>
                    <h1 class="">Score-Based</h1>
                    <h1>&nbsp;</h1>
                    <h1 class="">Generative
                        Modelling</h1>
                </div>
                <div class="r-stretch r-vstack w-100 items-center">
                    <div class="w-100 d-table">
                        <div class="d-table-row">
                            <div class="d-table-head">Ingredient \ Space</div>
                            <div class="d-table-head">Euclidean</div>
                            <div class="d-table-head">'Generic' Manifold</div>
                            <div class="d-table-head">Compact Manifold</div>
                        </div>
                        <div class="d-table-row">
                            <div class="d-table-cell" data-id="FP">
                                Forward Process
                            </div>
                            <div class="d-table-cell">OU</div>
                            <div class="d-table-cell">Langevin
                                dynamics </div>
                            <div class="d-table-cell">Langevin dynamics</div>
                        </div>
                        <div class="d-table-row">
                            <div class="d-table-cell">Base distribution</div>
                            <div class="d-table-cell">Gaussian</div>
                            <div class="d-table-cell" data-id="wrap">Wrapped normal</div>
                            <div class="d-table-cell" data-id="unif">Uniform</div>
                        </div>
                        <div class="d-table-row">
                            <div class="d-table-cell" data-id="time">Time reversal</div>
                            <div class="d-table-cell">Cattiaux, 2021</div>
                            <div class="d-table-cell" style="vertical-align: middle;"><img style="height: 0.8em;"
                                    class="my-0" src="figures/icons/cross.svg">
                            </div>
                            <div class="d-table-cell" style="vertical-align: middle;"><img style="height: 0.8em;"
                                    class="my-0" src="figures/icons/cross.svg">
                            </div>
                        </div>
                        <div class="d-table-row">
                            <div class="d-table-cell">SDE Discretisation</div>
                            <div class="d-table-cell">Eular-Maruyama</div>
                            <div class="d-table-cell" style="vertical-align: middle;"><img style="height: 0.8em;"
                                    class="my-0" src="figures/icons/cross.svg">
                            </div>
                            <div class="d-table-cell" style="vertical-align: middle;"><img style="height: 0.8em;"
                                    class="my-0" src="figures/icons/cross.svg">
                            </div>
                        </div>
                        <div class="d-table-row">
                            <div class="d-table-cell">Score-matching</div>
                            <div class="d-table-cell">Denoising</div>
                            <div class="d-table-cell" style="vertical-align: middle;"><img style="height: 0.8em;"
                                    class="my-0" src="figures/icons/cross.svg">
                            </div>
                            <div class="d-table-cell" style="vertical-align: middle;"><img style="height: 0.8em;"
                                    class="my-0" src="figures/icons/cross.svg">
                            </div>
                        </div>
                        <div class="d-table-row">
                            <div class="d-table-cell"> Sample \(p_{t|0}(\m{X}_t|\m{X}_0)\)</div>
                            <div class="d-table-cell">Analytic</div>
                            <div class="d-table-cell" style="vertical-align: middle;"><img style="height: 0.8em;"
                                    class="my-0" src="figures/icons/cross.svg">
                            </div>
                            <div class="d-table-cell" style="vertical-align: middle;"><img style="height: 0.8em;"
                                    class="my-0" src="figures/icons/cross.svg">
                            </div>
                        </div>
                        <div class="d-table-row">
                            <div class="d-table-cell">\(\condscore\)</div>
                            <div class="d-table-cell">Analytic</div>
                            <div class="d-table-cell" style="vertical-align: middle;"><img style="height: 0.8em;"
                                    class="my-0" src="figures/icons/cross.svg">
                            </div>
                            <div class="d-table-cell" style="vertical-align: middle;"><img style="height: 0.8em;"
                                    class="my-0" src="figures/icons/cross.svg">
                            </div>
                        </div>
                    </div>
            </section>

            <section data-auto-animate="" hidden="" aria-hidden="true" class="future" style="display: block;">
                <div class="r-hstack justify-start h5">
                    <h1 class="">
                        <div data-id="time">Time reversal</div>
                    </h1>
                    <h1>&nbsp;</h1>
                    <h1 class="">on</h1>
                    <h1>&nbsp;</h1>
                    <h1 class="">Euclidean space</h1>
                </div>
                <div class="r-vstack">
                    <div class="nice-box w-100" data-id="thm">
                        <b>Theorem (Time-reversal of linear SDEs on \(\R^n\)):</b><br>
                        Let \((\X)_{t\in[0,T]}\) with be
                        associated with the SDE \(\d \X = \drift \d t + \noise \brownian\).<br>
                        Then the time-reversal \((\Y)_{t \in [0,T]} = (\m{X}_{T-t})_{t\in [0,T]}\) is associated with
                        <div class="mt-3 w-100 r-hstack">
                            \( \d \Y = \sbr{\driftrev + \noiserev^2 \scorerev}\d t + \noiserev \brownian \)
                        </div>
                    </div>
                    <p class=" mb-2 fragment">
                        This result has been proved in a number of ways with increasingly modern tools, some
                        examples:
                    </p>
                    <ul>
                        <li class="fragment">Anderson 1982 (light on rigour, stochastic control point of view)</li>
                        <li class="fragment">Haussmann and Pardoux 1986 (PDE point of view) </li>
                        <li class="fragment">Cattiaux et al. 2021, Theorem 4.9 (rigorous Anderson)</li>
                    </ul>
                    <p class="fragment">but none of these results apply outside the Euclidean setting <span
                            class="fragment fade-up">\(\rightarrow\) we will need
                            to
                            generalise this.</span></p>
                </div>
            </section>

            <section data-auto-animate="" hidden="" aria-hidden="true" class="future" style="display: block;">
                <div class="r-hstack justify-start h5">
                    <h1 class="">
                        <div data-id="time">Time reversal</div>
                    </h1>
                    <h1>&nbsp;</h1>
                    <h1 class="">on</h1>
                    <h1>&nbsp;</h1>
                    <h1 class="">Riemannian manifolds</h1>
                </div>
                <div class="r-vstack">
                    <div class="nice-box w-100" data-id="thm">
                        <div class="r-hstack justify-start w-100" style="font-weight: bold;">
                            <div data-id="thm-name">Theorem 3.6</div>&nbsp;(Time-reversal of
                            linear
                            SDEs on manifolds)
                        </div>

                        Let \((\X)_{t\in[0,T]}\) with be
                        associated with the SDE \(\d \X = \drift \d t + \noise \brownian^\c{M}\).<br>
                        Then the time-reversal \((\Y)_{t \in [0,T]} = (\m{X}_{T-t})_{t\in [0,T]}\) is associated with
                        <div class="mt-3 w-100 r-hstack fragment animate-1-5" data-fragment-index="9">
                            \(\d \Y = \sbr{\driftrev + \noiserev^2 \scorerev}\d t + \noiserev \brownian^\c{M} \)
                        </div>
                    </div>
                    <p class="w-100 fragment" data-fragment-index="1">Why is this hard? <span class="fragment"
                            data-fragment-index="2">\(\rightarrow\) Geometry \(\cap\)
                            Stochastic
                            processes
                            throws up technical difficulties with regularity of functions.</span></p>
                    <p class="w-100 my-0 fragment" data-fragment-index="3">How do we solve this in the end?
                    </p>
                    <ul class="fragment" data-fragment-index="4">
                        <li>Following the spirit of Cattieux's proof.</li>
                        <li>State a simplified version of the theorem for Markov processes.</li>
                        <li>Verify the regularity conditions by adapting Girsanov theory to manifolds, utilising the
                            Nash embedding theorem.</li>
                    </ul>
                </div>
            </section>

            <section hidden="" aria-hidden="true" class="future" style="display: block;">
                <div class="r-hstack justify-start h5">
                    <h1 class="">
                        <div data-id="time">Time reversal</div>
                    </h1>
                    <h1>&nbsp;</h1>
                    <h1 class="">on</h1>
                    <h1>&nbsp;</h1>
                    <h1 class="">Riemannian manifolds</h1>
                    <h1>&nbsp;</h1>
                    <h1 class="">simplified</h1>
                </div>
                <div class="r-vstack">
                    <div class="nice-box w-100" data-id="thm">
                        <div class="r-hstack justify-start w-100" style="font-weight: bold;">
                            <div data-id="thm-name">Theorem 3.5</div>&nbsp;(Time-reversal of
                            linear
                            SDEs on manifolds)
                        </div>

                        Let \((\X)_{t\in[0,T]}\) with be
                        associated with the SDE \(\d \X = \drift \d t + \noise \brownian^\c{M}\).<br>
                        Then the time-reversal \((\Y)_{t \in [0,T]} = (\m{X}_{T-t})_{t\in [0,T]}\) is associated with
                        <div class="mt-3 w-100 r-hstack animate-1-5" data-fragment-index="9">
                            \(\d \Y = \sbr{\driftrev + \noiserev^2 \scorerev}\d t + \noiserev \brownian^\c{M} \)
                        </div>
                    </div>
                    <p class="w-100">A simpler strategy exists to have a valid time reversal for generative modelling.
                    </p>
                    <ul>
                        <li>By choosing only to match the time-marginal distributions, we can forget about the
                            complexity of proving the distribution on paths is the same.</li>
                        <li>Proof inspired by Nelson, 1967.</li>
                        <li>New for the thesis.</li>
                    </ul>

                </div>
            </section>

            <section data-auto-animate="" hidden="" aria-hidden="true" class="future" style="display: block;">
                <div class="r-stretch r-vstack w-100 items-center">
                    <div class="w-100 d-table">
                        <div class="d-table-row">
                            <div class="d-table-head">Ingredient \ Space</div>
                            <div class="d-table-head">Euclidean</div>
                            <div class="d-table-head">'Generic' Manifold</div>
                            <div class="d-table-head">Compact Manifold</div>
                        </div>
                        <div class="d-table-row">
                            <div class="d-table-cell" data-id="FP">
                                Forward Process
                            </div>
                            <div class="d-table-cell">OU</div>
                            <div class="d-table-cell">Langevin
                                dynamics </div>
                            <div class="d-table-cell">Langevin dynamics</div>
                        </div>
                        <div class="d-table-row">
                            <div class="d-table-cell">Base distibution
                            </div>
                            <div class="d-table-cell">Gaussian</div>
                            <div class="d-table-cell" data-id="wrap">Wrapped normal</div>
                            <div class="d-table-cell" data-id="unif">Uniform</div>
                        </div>
                        <div class="d-table-row">
                            <div class="d-table-cell" data-id="time">Time reversal</div>
                            <div class="d-table-cell">Cattiaux, 2021</div>
                            <div class="d-table-cell" data-id="thm-name">Theorem 3.6</div>
                            <div class="d-table-cell">Theorem 3.6</div>

                        </div>
                        <div class="d-table-row o-20">
                            <div class="d-table-cell">
                                <div class="r-hstack items-start justify-start">
                                    <div data-id="sde">SDE</div>&nbsp;
                                    <div data-id="disc">Discretis</div>ation
                                </div>
                            </div>
                            <div class="d-table-cell">Eular-Maruyama</div>
                            <div class="d-table-cell">
                                <div data-id="grw">GRW</div>
                            </div>
                            <div class="d-table-cell">
                                GRW
                            </div>
                        </div>
                        <div class="d-table-row">
                            <div class="d-table-cell">
                                <div data-id="sm">Score-matching</div>
                            </div>
                            <div class="d-table-cell">
                                <div class="r-hstack">
                                    <div data-id="denoise">Denoising</div>
                                </div>
                            </div>
                            <div class="d-table-cell" style="vertical-align: middle;"><img style="height: 0.8em;"
                                    class="my-0" src="figures/icons/cross.svg">
                            </div>
                            <div class="d-table-cell" style="vertical-align: middle;"><img style="height: 0.8em;"
                                    class="my-0" src="figures/icons/cross.svg">
                            </div>
                        </div>
                        <div class="d-table-row">
                            <div class="d-table-cell"> Sample \(p_{t|0}(\m{X}_t|\m{X}_0)\)</div>
                            <div class="d-table-cell">Analytic</div>
                            <div class="d-table-cell" style="vertical-align: middle;"><img style="height: 0.8em;"
                                    class="my-0" src="figures/icons/cross.svg">
                            </div>
                            <div class="d-table-cell" style="vertical-align: middle;"><img style="height: 0.8em;"
                                    class="my-0" src="figures/icons/cross.svg">
                            </div>
                        </div>
                        <div class="d-table-row">
                            <div class="d-table-cell">\(\condscore\)</div>
                            <div class="d-table-cell">Analytic
                            </div>
                            <div class="d-table-cell" style="vertical-align: middle;"><img style="height: 0.8em;"
                                    class="my-0" src="figures/icons/cross.svg">
                            </div>
                            <div class="d-table-cell" style="vertical-align: middle;"><img style="height: 0.8em;"
                                    class="my-0" src="figures/icons/cross.svg">
                            </div>
                        </div>
                    </div>
            </section>


            <section data-auto-animate="" hidden="" aria-hidden="true" class="future" style="display: block;">
                <div class="r-hstack justify-start h5">
                    <h1 class="">
                        <div data-id="denoise">Denoising</div>
                    </h1>
                    <h1>&nbsp;</h1>
                    <h1>
                        <div data-id="sm">Score-matching</div>
                    </h1>
                    <h1>s&nbsp;</h1>
                    <h1 class="">
                        <div>on Manifolds</div>
                    </h1>
                </div>
                <div class="r-vstack justify-start items-start">
                    <p class="fragment">Fortunately the denoising score-matching objective carries over with no trouble
                        to manifolds.
                        That is</p>
                    <div class="w-100 fragment">\[\score = \underset{\m{s} \in
                        L^2}{\operatorname{argmin}}\; \int \textcolor{red}{\lambda(t)}
                        \E_{\m{X}_0 \sim p_0}\E_{\m{X}_t | \m{X}_0 \sim p_{t|0}} \sbr{\norm{\m{s}(t, \m{X}_t) -
                        \nabla_{\m{X}} \log
                        p_t(\m{X}_t | \m{X}_0)}^2} \d t \]
                    </div>
                    <p class="fragment">Our issue comes with evaluating \(\nabla_{\m{X}_t}\log
                        p_{t|0}(\m{X}_t | \m{X}_0)\) and sampling \(p_{t|0}(\m{X}_t | \m{X}_0)\)</p>
                    <ul>
                        <li class="fragment">For the wrapped Gaussian SDE, we don't have a closed form for sampling or
                            evaluation.</li>
                        <li class="fragment">For Brownian motion SDE, this is the <em>heat kernel</em>
                            <ul>
                                <li class="fragment">
                                    <div class="r-hstack items-start justify-start">
                                        <div data-id="approx-score">\(\nabla_{\m{X}_t}\log
                                            p_{t|0}(\m{X}_t | \m{X}_0)
                                            \) has approximations.</div>
                                    </div>
                                </li class="fragment">
                                <li class="fragment">Sampling analytically is still difficult, but we can approximate
                                    cheaply with discretisations.</li>
                            </ul>
                        </li>
                    </ul>
                </div>
            </section>

            <section data-auto-animate="" hidden="" aria-hidden="true" class="future" style="display: block;">
                <div class="r-hstack justify-start h5">
                    <h1>
                        <div data-id="approx-score">Approximating \(\nabla_{\m{X}_t}\log
                            p_{t|0}(\m{X}_t | \m{X}_0)
                            \)</div>
                    </h1>
                    <h1>&nbsp;</h1>
                    <h1 class="">
                        <div>on Manifolds</div>
                    </h1>

                </div>
                <div class="columns">
                    <div class="column">
                        <h5 class="fragment"><b>Strum-Louiville (compact only)</b></h5>
                        <p class="fragment">If we have the <em>eigenpairs</em> \((\lambda_j, \phi_j)\) of the
                            <em>Laplace-Beltrami
                                operator \( \Delta_\c{M}\)</em> then
                        </p>
                        <div class="w-100 fragment">
                            <div class="w-100">
                                \( p_{t|0}(\m{X}_t | \m{X}_0) =\)
                            </div>
                            <div class="w-100 mt-2">
                                \(\sum_{j\in\N} e^{-\lambda_i t} \phi_j(\m{X}_0) \phi_j(\m{X}_t) \)
                            </div>
                        </div>
                    </div>
                    <div class="column">
                        <h5 class="fragment"><b>Varadhan</b></h5>
                        <p class="fragment">Alternatively we have in the small time limit:</p>
                        <div class="w-100 fragment">

                            <div class="w-100">
                                \( \lim_{t\to 0} \nabla_{\m{X}_t}\log
                                p_{t|0}(\m{X}_t | \m{X}_0)\)
                            </div>
                            <div class="w-100 mt-2">
                                \( = \exp^{-1}(\m{X}_t, \m{X}_0) / t\)
                            </div>
                        </div>
                    </div>
                </div>
                <img class="img-fluid w-75 mt-5 fragment" src="figures/s2_heat_kernel_approximation.svg">
            </section>
            <section data-auto-animate="" hidden="" aria-hidden="true" class="future" style="display: block;">
                <div class="r-hstack justify-start h5">
                    <h1 class="">
                        <div data-id="denoise">Implicit</div>
                    </h1>
                    <h1>&nbsp;</h1>
                    <h1 class="">Score Matching</h1>
                    <h1>&nbsp;</h1>
                    <h1 class="">
                        <div>on Manifolds&nbsp;</div>
                    </h1>
                    <h1>[Hyvärinen
                        2005]</h1>
                </div>
                <p class="fragment">What if we can't approximate the conditional score?</p>
                <div class="r-hstack justify-around">
                    <div class="r-vstack w-75">
                        <div class="w-100 fragment r-hstack items-start justify-start mb-3">
                            \(\E_{\m{X}_t\sim p_t} \sbr{ \norm{\score - \m{s}(\m{X}_t)}^2 }\)
                        </div>
                        <div class="w-100 fragment r-hstack items-start justify-start mb-3">
                            \(=\E_{\m{X}_t\sim
                            p_t} \sbr{ \textcolor{red}{C}-2
                            \innerprod{\score}{\m{s}(\m{X}_t)} + \norm{\m{s}(\m{X}_t)}^2} \)
                        </div>
                        <div class="w-100 fragment r-hstack items-start justify-start mb-3">
                            \(=\E_{\m{X}_t\sim
                            p_t} \sbr{ \textcolor{red}{C}-2
                            \innerprod{\frac{\nabla_{\m{X}_t}\textcolor{green}{p_t(\m{X}_t)}}{\textcolor{green}{p_t(\m{X}_t)}}}{\m{s}(\m{X}_t)}
                            +
                            \norm{\m{s}(\m{X}_t)}^2}\)
                        </div>
                        <div class="w-100 fragment r-hstack items-start justify-start mb-3">
                            \(=\E_{\m{X}_t\sim
                            p_t} \sbr{ \textcolor{red}{C}+2
                            \innerprod{\frac{\textcolor{green}{p_t(\m{X}_t)}}{\textcolor{green}{p_t(\m{X}_t)}}}{\operatorname{div}(\m{s})(\m{X}_t)}
                            +
                            \norm{\m{s}(\m{X}_t)}^2}\)
                        </div>
                        <div class="w-100 fragment r-hstack items-start justify-start mb-3">
                            \(=\E_{\m{X}_t\sim
                            p_t} \sbr{ \textcolor{red}{C} + 2
                            \operatorname{div}{(\m{s})(\m{X}_t)} + \norm{\m{s}(\m{X}_t)}^2} \)
                        </div>
                        <div class="w-100 fragment r-hstack items-start justify-start mb-3">

                            <div data-id="ISM">
                                \(=\E_{\m{X}_0\sim
                                p_0, \m{X}_t \sim p_{t|0}(\m{X}_t | \m{X}_0)} \sbr{ \textcolor{red}{C} + 2
                                \operatorname{div}{(\m{s})(\m{X}_t)} + \norm{\m{s}(\m{X}_t)}^2}\)</div>
                        </div>
                    </div>
                </div>
            </section>

            <section data-auto-animate="" hidden="" aria-hidden="true" class="future" style="display: block;">
                <div class="r-hstack justify-start h5">
                    <h1 class="">
                        <div data-id="denoise">Implicit</div>
                    </h1>
                    <h1>&nbsp;</h1>
                    <h1 class="">Score Matching</h1>
                    <h1>&nbsp;</h1>
                    <h1 class="">on</h1>
                    <h1>&nbsp;</h1>
                    <h1 class="">Manifolds [Hyvärinen
                        2005]</h1>
                </div>
                <div class="w-100 r-hstack items-start justify-around mt-3">
                    <div data-id="ISM">
                        \(=\E_{\m{X}_0\sim
                        p_0, \m{X}_t \sim p_{t|0}(\m{X}_t | \m{X}_0)} \sbr{ \textcolor{red}{C} + 2
                        \operatorname{div}{(\m{s})(\m{X}_t)} + \norm{\m{s}(\m{X}_t)}^2}\)</div>
                </div>
                <p class="fragment">Using a divergence theorem for non-compact manifolds
                    (e.g. Gaffney 1954) we can show an identical result. <span style="opacity: 20%;">with some
                        regularity conditions...</span>
                </p>
                <p class="fragment">That is:</p>
                <div class="w-100 fragment">
                    \[ \score = \underset{\m{s}\in L^2}{\operatorname{argmin}} \int_0^T \textcolor{red}{\lambda(t)}
                    \E_{\m{X}_0\sim
                    p_0, \m{X}_t \sim p_{t|0}(\m{X}_t | \m{X}_0)} \sbr{2
                    \operatorname{div}_\c{M}{(\m{s})(\m{X}_t)} + \norm{\m{s}(\m{X}_t)}^2_\c{M}} \d t \]
                </div>
                <p class="fragment">And the usual Hutchinson trace trick estimator can be used [Song et al. 2019].</p>

            </section>

            <section data-auto-animate="" hidden="" aria-hidden=" true" class="future" style="display: block;">
                <div class="r-stretch r-vstack items-center">

                    <table class="w-100 small">
                        <tr class="">
                            <th class="" style="border: 0 !important;">Loss</th>
                            <th class="" style="border: 0 !important;">Approximation</th>
                            <th class="" style="border: 0 !important;">Loss function</th>
                            <th class="" style="border: 0 !important;" colspan="2">Requirements</th>
                            <th class="" style="border: 0 !important;">Complexity</th>
                        </tr>
                        <tr class="midrule">
                            <th class=""></th>
                            <th class=""></th>
                            <th class=""></th>
                            <th class="">\(p_{t|0}\)</th>
                            <th class="">\( \exp^{-1} \)</th>
                            <th class=""></th>
                        </tr>
                        <tr>
                            <td rowspan="3" style="vertical-align: middle;">DSM</td>
                            <td>None</td>
                            <td>\(\E\sbr{\norm{\m{s}(\X ) - \nabla_{\m{X}_t}\log
                                p_{t|0}(\m{X}_t | \m{X}_0)}^2}\)</td>
                            <td>
                                <img style="height: 0.8em;" class="my-0 img-fluid" src="figures/icons/tick.svg">
                            </td>
                            <td>
                                <img style="height: 0.8em;" class="my-0 img-fluid" src="figures/icons/cross.svg">
                            </td>
                            <td>\(\c{O}(1)\)</td>
                        </tr>
                        <tr>
                            <td style="text-align: center;">Truncation</td>
                            <td>\(\E\sbr{\norm{\m{s}(\X ) - \nabla_{\m{X}_t}\log S_J(\m{X}_t, \m{X}_0)}^2}\)</td>
                            <td>Expansion</td>
                            <td>
                                <img style="height: 0.8em;" class="my-0 img-fluid" src="figures/icons/cross.svg">
                            </td>
                            <td>\(\c{O}(1)\)</td>
                        </tr>
                        <tr class="midrule">
                            <td style="text-align: center;">Varhardan</td>
                            <td>\(\E\sbr{\norm{\m{s}(\X ) - \exp_{\m{X}_t}^{-1}(\m{X}_s)/t}}\)</td>
                            <td>
                                <img style="height: 0.8em;" class="my-0 img-fluid" src="figures/icons/cross.svg">
                            </td>
                            <td>
                                <img style="height: 0.8em;" class="my-0 img-fluid" src="figures/icons/tick.svg">
                            </td>
                            <td>\(\c{O}(1)\)</td>
                        </tr>
                        <tr>
                            <td rowspan="2" style="vertical-align: middle;">ISM</td>
                            <td>Deterministic</td>
                            <td>\(\E\sbr{\norm{\m{s}(t, \m{X}_t)}^2 + 2 \operatorname{div}(t, \cdot)(\m{X}_t)}\)</td>
                            <td>
                                <img style="height: 0.8em;" class="my-0 img-fluid" src="figures/icons/cross.svg">
                            </td>
                            <td>
                                <img style="height: 0.8em;" class="my-0 img-fluid" src="figures/icons/cross.svg">
                            </td>
                            <td>\(\c{O}(d)\)</td>
                        </tr>
                        <tr>
                            <td style="text-align: center;">Stochastic</td>
                            <td>\(\E\sbr{\norm{\m{s}(t, \m{X}_t)}^2 + 2 \m{\varepsilon}^\top\operatorname{div}(t,
                                \cdot)(\m{X}_t)\m{\varepsilon}}\)</td>

                            <td>
                                <img style="height: 0.8em;" class="my-0 img-fluid" src="figures/icons/cross.svg">
                            </td>
                            <td>
                                <img style="height: 0.8em;" class="my-0 img-fluid" src="figures/icons/cross.svg">
                            </td>
                            <td>\(\c{O}(1)\)</td>
                        </tr>
                    </table>
                </div>
            </section>

            <section hidden="" aria-hidden="true" class="future" style="display: block;">
                <div class="r-stretch r-vstack w-100 items-center">
                    <div class="w-100 d-table">
                        <div class="d-table-row">
                            <div class="d-table-head">Ingredient \ Space</div>
                            <div class="d-table-head">Euclidean</div>
                            <div class="d-table-head">'Generic' Manifold</div>
                            <div class="d-table-head">Compact Manifold</div>
                        </div>
                        <div class="d-table-row">
                            <div class="d-table-cell" data-id="FP">
                                Forward Process
                            </div>
                            <div class="d-table-cell">OU</div>
                            <div class="d-table-cell">Langevin
                                dynamics </div>
                            <div class="d-table-cell">Langevin dynamics</div>
                        </div>
                        <div class="d-table-row">
                            <div class="d-table-cell">Base distribution</div>
                            <div class="d-table-cell">Gaussian</div>
                            <div class="d-table-cell" data-id="wrap">Wrapped normal</div>
                            <div class="d-table-cell" data-id="unif">Uniform</div>
                        </div>
                        <div class="d-table-row">
                            <div class="d-table-cell" data-id="time">Time reversal</div>
                            <div class="d-table-cell">Cattiaux, 2021</div>
                            <div class="d-table-cell" data-id="thm-name">Theorem 3.6</div>
                            <div class="d-table-cell">Theorem 3.6</div>

                        </div>
                        <div class="d-table-row o-20">
                            <div class="d-table-cell">
                                <div class="r-hstack items-start justify-start">
                                    <div data-id="sde">SDE</div>&nbsp;
                                    <div data-id="disc">Discretis</div>ation
                                </div>
                            </div>
                            <div class="d-table-cell">Eular-Maruyama</div>
                            <div class="d-table-cell">
                                <div data-id="grw">GRW</div>
                            </div>
                            <div class="d-table-cell">
                                GRW
                            </div>
                        </div>
                        <div class="d-table-row">
                            <div class="d-table-cell">
                                <div data-id="sm">Score-matching</div>
                            </div>
                            <div class="d-table-cell">
                                <div class="r-hstack">
                                    <div data-id="denoise">Denoising</div>/Implicit
                                </div>
                            </div>
                            <div class="d-table-cell" style="vertical-align: middle;">
                                <div class="r-hstack">
                                    <div data-id="denoise">Denoising</div>/Implicit
                                </div>
                            </div>
                            <div class="d-table-cell" style="vertical-align: middle;">
                                <div class="r-hstack">
                                    <div data-id="denoise">Denoising</div>/Implicit
                                </div>
                            </div>
                        </div>
                        <div class="d-table-row">
                            <div class="d-table-cell"> Sample \(p_{t|0}(\m{X}_t|\m{X}_0)\)</div>
                            <div class="d-table-cell">Analytic</div>
                            <div class="d-table-cell" style="vertical-align: middle;">Discretise SDE
                            </div>
                            <div class="d-table-cell" style="vertical-align: middle;">Discretise SDE
                            </div>
                        </div>
                        <div class="d-table-row items-start justify-start">
                            <div class="d-table-cell">\(\condscore\)</div>
                            <div class="d-table-cell">Analytic</div>
                            <div class="d-table-cell"><img style=" height: 0.8em;" class="my-0" data-id="None"
                                    src="figures/icons/cross.svg">
                                - Use ISM
                            </div>
                            <div class="d-table-cell" style="vertical-align: middle;">Strum-Louiville<br>& Varadhan
                                Approx.
                            </div>
                        </div>
                    </div>
            </section>
            <section data-auto-animate="" hidden="" aria-hidden="true" class="future" style="display: block;">
                <div class="r-stretch r-vstack items-center">
                    <h1 class="h2">Experimental Validation</h1>
                </div>
            </section>

            <section data-auto-animate="" hidden="" aria-hidden="true" class="future" style="display: block;">
                <div class="r-hstack justify-start h5">
                    <h1>Baseline Methods</h1>
                </div>
                <div class="r-vstack w-100 mt-n4">
                    <div class="w-100 items-start justify-start">
                        <div class="w-100 items-start justify-start">
                            <h1 class="fragment">Riemannian Continuous Normalising Flows (RCNFs) <em>[Mathiue & Nickel
                                    2020]</em></h1>
                            <ul>
                                <li class="fragment">Map a simple density under a vector field flow to a complex
                                    density.
                                </li>
                                <li class="fragment">Compute the change in density via the log-det-Jacobian of this
                                    flow.
                                </li>
                                <li class="fragment">Train with maximum likelihood.</li>
                                <li class="fragment">Requires full forward/backward simulation to train.</li>
                            </ul>
                        </div>
                        <div class="w-100 items-start justify-start">
                            <h1 class="fragment">Moser Flows <em>[Rozen et al. 2020]</em></h1>
                            <ul>
                                <li class="fragment">Specify the <em>form</em> for the vector field flow as the linear
                                    interpolation of the
                                    start/end distributions.</li>
                                <li class="fragment">&#128077 Exploit a property to get simulation-free likelihoods for
                                    training.</li>
                                <li class="fragment">&#128078 Require a regulariser that integrates over the whole
                                    domain.
                                </li>
                            </ul>
                        </div>
                        <div class="w-100 r-hstack items-start justify-start">
                            <h1 class="fragment">Wrapped SGMs</h1>
                        </div>
                    </div>
            </section>

            <section data-auto-animate="" hidden="" aria-hidden="true" class="future" style="display: block;">
                <div class="r-hstack justify-start h5">
                    <h1>Earth-Science Datasets</h1>
                </div>
                <div class="r-vstack w-100">

                    <div class="r-hstack w-100 items-center justify-around fragment">
                        <div class=" r-vstack" style="width: 20%">
                            <img class="img-fluid w-100 my-0" m src="figures/manifold/earth_science/volcano.png">
                            <div class="p-div caption mb=0 mt-2">Volcanoes</div>
                        </div>
                        <div class="r-vstack" style="width: 20%">
                            <img class="img-fluid w-100 my-0" m src="figures/manifold/earth_science/earthquake.png">
                            <div class="p-div caption mb=0 mt-2">Earthquakes</div>
                        </div>
                        <div class="r-vstack" style="width: 20%">
                            <img class="img-fluid w-100 my-0" m src="figures/manifold/earth_science/flood.png">
                            <div class="p-div caption mb=0 mt-2">Floods</div>
                        </div>
                        <div class="r-vstack" style="width: 20%">
                            <img class="img-fluid w-100 my-0" m src="figures/manifold/earth_science/fire.png">
                            <div class="p-div caption mb=0 mt-2">Fires</div>
                        </div>
                    </div>
                    <div class="d-table w-100 small fragment">
                        <div class=" d-table-row">
                            <div class="d-table-head">Method</div>
                            <div class="d-table-head">Volcanoes</div>
                            <div class="d-table-head">Earthquakes</div>
                            <div class="d-table-head">Floods</div>
                            <div class="d-table-head">Fires</div>
                        </div>
                        <div class="d-table-row">
                            <div class="d-table-cell">Riemannian CNF</div>
                            <div class="d-table-cell">$\mathbf{-6.05_{\pm 0.61}}$</div>
                            <div class="d-table-cell">${0.14_{\pm 0.23}}$</div>
                            <div class="d-table-cell">${1.11_{\pm 0.19}}$</div>
                            <div class="d-table-cell">$\mathbf{-0.80_{\pm 0.54}}$</div>
                        </div>
                        <div class="d-table-row">
                            <div class="d-table-cell">Moser Flow</div>
                            <div class="d-table-cell">${-4.21_{\pm 0.17}}$</div>
                            <div class="d-table-cell">$\mathbf{-0.16_{\pm 0.06}}$</div>
                            <div class="d-table-cell">$\mathbf{0.57_{\pm 0.10}}$</div>
                            <div class="d-table-cell">$\mathbf{-1.28_{\pm 0.05}}$</div>
                        </div>
                        <div class="d-table-row" style="background-color: #D4E6F1;">
                            <div class="d-table-cell">Sterorgraphic SGM</div>
                            <div class="d-table-cell">${-3.80_{\pm 0.27}}$</div>
                            <div class="d-table-cell">$\mathbf{-0.19_{\pm 0.05}}$</div>
                            <div class="d-table-cell">$\mathbf{0.59_{\pm 0.07}}$</div>
                            <div class="d-table-cell">$\mathbf{-1.28_{\pm 0.12}}$</div>
                        </div>
                        <div class="d-table-row d-table-bottom-border" style="background-color: #D4E6F1;">
                            <div class="d-table-cell">Riemannian SGM</div>
                            <div class="d-table-cell">${-4.92_{\pm 0.25}}$</div>
                            <div class="d-table-cell">$\mathbf{-0.19_{\pm 0.07}}$</div>
                            <div class="d-table-cell">$\mathbf{0.45_{\pm 0.17}}$</div>
                            <div class="d-table-cell">$\mathbf{-1.33_{\pm 0.06}}$</div>
                        </div>
                        <div class="d-table-row">
                            <div class="d-table-cell">Dataset Size</div>
                            <div class="d-table-cell">827</div>
                            <div class="d-table-cell">6120</div>
                            <div class="d-table-cell">4875</div>
                            <div class="d-table-cell">12809</div>
                        </div>
                    </div>
                </div>
            </section>

            <section data-auto-animate="" hidden="" aria-hidden="true" class="future" style="display: block;">
                <div class="r-hstack justify-start h5">
                    <h1>High-Dimension Tori</h1>
                </div>
                <p class="fragment mt-n4">Place a 2-mode mixture-of-Gaussian ditribution on \(\c{S}_1^n\).</p>
                <div class="r-vstack w-100 fragment">
                    <img class="img-fluid w-100" src="figures/manifold/high-dim.svg">
                </div>
            </section>

            <section data-auto-animate="" hidden="" aria-hidden="true" class="future" style="display: block;">
                <div class="r-hstack justify-start h5">
                    <h1>Synthetic $SO(3)$ data</h1>
                </div>
                <p class="fragment mt-n4">Place a M-mode mixture-of-Gaussian ditribution on \(SO(3)\).</p>

                <div class="r-vstack w-100 fragment">
                    <table class="w-100 small">
                        <tr>
                            <th rowspan="2" style="vertical-align: middle; text-align: left;">Method</th>
                            <th colspan="2">$M=16$</th>
                            <th colspan="2">$M=32$</th>
                            <th colspan="2">$M=64$</th>
                        </tr>
                        <tr>
                            <th>LL</th>
                            <th>NFE ($\times 10^3$)</th>
                            <th>LL</th>
                            <th>NFE ($\times 10^3$)</th>
                            <th>LL</th>
                            <th>NFE ($\times 10^3$)</th>
                        </tr>
                        <tr>
                            <td>Moser Flow</td>
                            <td>$0.85_{\pm 0.03}$</td>
                            <td>$2.3_{\pm0.5}$</td>
                            <td>$0.17_{\pm0.03}$</td>
                            <td>$2.3_{\pm0.9}$</td>
                            <td>$-0.49_{\pm0.02}$</td>
                            <td>$7.3_{\pm1.4}$</td>
                        </tr>
                        <tr>
                            <td>Exp-wrapped SGMs</td>
                            <td>$0.87_{\pm 0.04}$</td>
                            <td>$0.5_{\pm0.1}$</td>
                            <td>$0.16_{\pm0.03}$</td>
                            <td>$0.5_{\pm0.0}$</td>
                            <td>$-0.58_{\pm0.04}$</td>
                            <td>$0.5_{\pm0.0}$</td>
                        </tr>
                        <tr>
                            <td>RSGM</td>
                            <td>$0.89_{\pm 0.03}$</td>
                            <td>$0.1_{\pm0.0}$</td>
                            <td>$0.20_{\pm0.03}$</td>
                            <td>$0.1_{\pm0.0}$</td>
                            <td>$-0.49_{\pm0.02}$</td>
                            <td>$0.1_{\pm0.0}$</td>
                        </tr>
                    </table>
                    <div class="w-100 mt-0 fragment">
                        <img class="img-fluid w-100" src="figures/manifold/horizontal_vertical.svg">
                    </div>
                </div>
            </section>

            <section data-auto-animate="" hidden="" aria-hidden="true" class="future" style="display: block;">
                <div class="r-hstack justify-start h5">
                    <h1>Synthetic manifold/hyperbolic Distributions</h1>
                </div>
                <div class="w-100 r-stretch r-hstack items-center justify-around mb-5 ">
                    <div class=" r-vstack w-25">
                        <img class="img-fluid w-100 my-0" m src="figures/manifold/hyperbolic/ref.png">
                        <div class="p-div caption mb=0 mt-2">Target</div>
                    </div>
                    <div class=" r-vstack w-25">
                        <img class="img-fluid w-100 my-0" m src="figures/manifold/hyperbolic/exp_wrap.png">
                        <div class="p-div caption mb=0 mt-2">Exp-wrapped SGM</div>
                    </div>
                    <div class=" r-vstack w-25">
                        <img class="img-fluid w-100 my-0" m src="figures/manifold/hyperbolic/rsgm.png">
                        <div class="p-div caption mb=0 mt-2">RSGM</div>
                    </div>
                </div>
            </section>


            <section data-auto-animate="" hidden="" aria-hidden="true" class="future" style="display: block;">
                <div class="r-hstack justify-start h5">
                    <h1>Approch 1: Barrier methods - Intuition</h1>
                </div>
                <div class="r-vstack r-stretch items-center">
                    <img class="w-100" src="figures/constrained/hessian_density_no_text.svg">
                    <p class="">As the SDE moves towards the boundary, slow it down.</p>
                </div>
            </section>

            <section data-auto-animate="" hidden="" aria-hidden="true" class="future" style="display: block;">
                <div class="r-hstack justify-start h5">
                    <h1>Approch 1: Barrier methods - Barrier functions</h1>
                </div>
                <div class="w-100 r-vstack items-start justify-around mb-5 ">
                    <p>Construct a smooth convex potential that blows up near the boundary, \(\phi: \c{M} \to \R\)</p>
                    <p>First construct a distance function to the boundary</p>
                    <ul>
                        <li>For a manifold with boundary we can define this as \[d(x, \partial \c{M}) = \min_{y\in
                            \partial \c{M}} d(x, y).\]</li>
                        <li>For a constraint, we can define this as \[d(x, {f_i}) =
                            \min_{y\in \c{N}, f_i(y) = 0} d(x, y).\]</li>
                    </ul>
                    <p>Pass this thorugh a monotone decreasing function \(\phi: \R^+ \to \R\) such that \(\lim_{z
                        \rightarrow 0} \phi(z) = \infty\) to get the potential</p>
                    <div class="r-hstack r-stretch justify-around items-center w-100">
                        <div class="r-hstack r-stretch justify-around items-center w-75">
                            <p>\(\phi(\min_{i\in I} d(x, f_i))\)</p>
                            <p>or</p>
                            <p>\(\sum_{i \in I} \phi(d(x, f_i))\)</p>
                        </div>
                    </div>
                </div>
            </section>

            <section data-auto-animate="" hidden="" aria-hidden="true" class="future" style="display: block;">
                <div class="r-hstack justify-start h5">
                    <h1>Approch 1: Barrier methods - Hessian metrics</h1>
                </div>
                <div class="w-100 r-vstack items-start justify-around mb-5 ">
                    <p class="w-100">Using such a barrier function we can construct a <em>Hessian metric</em>, \[g =
                        \nabla^2 \phi.\]
                    </p>
                    <p class="w-100">Endowing \(\c{M}\) with this metic makes it a <em>Hessian manifold</em>,
                        \[\del{\c{M}, \nabla^2 \phi}.\]
                    </p>
                    <p class="w-100">These are <em>geodesially complete</em>, allowing us to contain the SDE to the
                        boundary.</p>
                    <p class="w-100">We get a forward noising process on the original manifold defined by \[ \mathrm{d}
                        \v{X}_t = \tfrac{1}{2}
                        \mathrm{div}({g}^{-1})( \v{X}_t) \mathrm{d} t + {g}( \v{X}_t)^{-\frac{1}{2}} \mathrm{d} \v{B}_t,
                        \]</p>
                </div>
            </section>

            <section data-auto-animate="" hidden="" aria-hidden="true" class="future" style="display: block;">
                <div class="r-hstack justify-start h5">
                    <h1>Approch 1: Barrier methods - New SDE</h1>
                </div>
                <div class="w-100 r-vstack items-start justify-around mb-5 ">
                    <div class="columns w-100 items-start">
                        <div class="r-vstack items-center w-50">
                            <img class="w-100" src="figures/constrained/hessian_density_no_text.svg">
                            <p class="small">\(\d\v{X}_t = \tfrac{1}{2} \dive(g^{-1})(\v{X}_t) \d t + g(\v{X}_t)^{-1/2}
                                \d \v{B}_t \)
                            </p>
                        </div>
                        <div class="r-vstack items-center w-50">
                            <img class="w-100" src="figures/constrained/dual_space.png">
                        </div>
                    </div>
                    <ul>
                        <li>Forward noising process converges to the uniform distribution.</li>
                        <li>For sampling, we don't have access to the exponential map, therefore use a
                            <em>retraction</em>.
                        </li>
                        <li>Time reversal derived from the previous chapter.</li>
                        <li>Technical results apply to compact, convex sets of Euclidean space.</li>
                    </ul>
                </div>
            </section>

            <section data-auto-animate="" hidden="" aria-hidden="true" class="future" style="display: block;">
                <div class="r-hstack justify-start h5">
                    <h1>Approch 2: Reflected SDEs - Intuition</h1>
                </div>
                <div class="r-vstack r-stretch items-start">
                    <img class="w-100" src="figures/constrained/reflected_density_no_text.svg">
                    <p class="">As the SDE hits the boundary, reflect it.</p>
                </div>

            </section>

            <section data-auto-animate="" hidden="" aria-hidden="true" class="future" style="display: block;">
                <div class="r-hstack justify-start h5">
                    <h1>Approch 2: Reflected SDEs - Formalisation</h1>
                </div>
                <div class="w-100 r-vstack items-start justify-around mb-5 ">
                    <p>Defined by <em>Skorokhod problems</em></p>
                    <div>
                        <p>Consists of a pair of processes \((\bar{ \v{B}}_t, \v{k}_t)_{t \geq 0}\), such that \[ \bar{
                            \v{B}}_t = \bar{ \v{B}}_0 + \v{B}_t - \v{k}_t \in \c{M}.\]</p>
                        <ul>
                            <li>\((\bar{ \v{B}}_t)_{t \geq 0}\) acts <em>locally</em> as a Euclidean Brownian motion, \(
                                (\v{B}_t)_{t \geq 0} \).</li>
                            <li>\( (\v{k}_t)_{t \geq 0}\) compensates for the excursion of \(( \v{B}_t)_{t \geq 0}\)
                                outside the boundary so that \((\bar{ \v{B}}_t)_{t \geq 0}\) remains in \(\c{M}\)</li>
                        </ul>
                    </div>
                    <div>
                        <p>Enforced by the conditions</p>
                        <ol>
                            <li>\({\abs{ \v{k}}_t = \int_0^t \mathbf{1}_{\bar{ \v{B}}_s \in \partial \c{M}} \mathrm{d}
                                \abs{ \v{k}}_s}\), where \(\v{1}\) is the indicator function.</li>
                            <li>\({ \v{k}_t = \int_0^t \v{n}(\bar{ \v{B}}_s) \mathrm{d} \abs{ \v{k}}_s ,}\)where
                                \((\abs{ \v{k}}_t)_{t \geq 0}\) is the total variation of \(( \v{k}_t)_{t \geq 0}\) and
                                \( \v{n}\) is the outward normal vector field to \(\c{M}\)</li>
                        </ol>
                    </div>
                </div>

            </section>
            <section data-auto-animate="" hidden="" aria-hidden="true" class="future" style="display: block;">
                <div class="r-hstack justify-start h5">
                    <h1>Approch 2: Reflected SDEs - Formalisation</h1>
                </div>
                <div class="w-100 r-vstack items-start justify-around mb-5 ">
                    <p>Defined by <em>Skorokhod problems</em></p>
                    <div>
                        <p>Consists of a pair of processes \((\bar{ \v{B}}_t, \v{k}_t)_{t \geq 0}\), such that \[ \bar{
                            \v{B}}_t = \bar{ \v{B}}_0 + \v{B}_t - \v{k}_t \in \c{M}.\]</p>
                        <ul>
                            <li>\((\bar{ \v{B}}_t)_{t \geq 0}\) acts <em>locally</em> as a Euclidean Brownian motion, \(
                                (\v{B}_t)_{t \geq 0} \).</li>
                            <li>\( (\v{k}_t)_{t \geq 0}\) compensates for the excursion of \(( \v{B}_t)_{t \geq 0}\)
                                outside the boundary so that \((\bar{ \v{B}}_t)_{t \geq 0}\) remains in \(\c{M}\)</li>
                        </ul>
                    </div>
                    <div class="w-100 r-vstack items-start justify-around mb-5">
                        <div class="columns w-100 items-start">
                            <div class="r-vstack items-center w-50">
                                <img class="w-100" src="figures/constrained/reflected_density.svg">
                            </div>
                            <div class="r-vstack items-center w-50">
                                <img class="w-100" src="figures/constrained/reflected_ks.svg">
                            </div>
                        </div>
                    </div>
                </div>

            </section>

            <section data-auto-animate="" hidden="" aria-hidden="true" class="future" style="display: block;">
                <div class="r-hstack justify-start h5">
                    <h1>Approch 2: Reflected SDEs - Time evolution</h1>
                </div>
                <div class="w-100 r-vstack items-center justify-around mb-5">
                    <div class="nice-box w-100" data-id="thm">
                        <b>Time evolution of the
                            density of a Skorokhod
                            problem:</b><br>
                        Let \((\X)_{t\in[0,T]}\) with be
                        associated with the SDE \(\d \X = \drift \d t + \noise \brownian\).<br>
                        For any \(t > 0\), the distribution of \(\bar{ \v{B}}_t\) admits a density with respect to the
                        Lebesgue measure denoted \(p_t\).
                        <br><br>

                        In addition, \[\partial_t p_t(x) = \tfrac{1}{2} \Delta p_t(x) , \quad
                        \partial_{ \v{n}} p_t(x_0) = 0 \] where \(\mathbf{n}\) is the
                        outward normal to \(\c{M}\).
                    </div>
                    <ul class="mt-3">
                        <li>The process will converge to the uniform distribution.
                        </li>
                        <li>We can prove a time reversal result, building from Petit, 1997.</li>
                        <li>Sampling can be performed by discretised reflections.</li>
                    </ul>
                </div>
            </section>

            <section data-auto-animate="" hidden="" aria-hidden="true" class="future" style="display: block;">
                <div class="r-hstack justify-start h5">
                    <h1>Approch 2: Reflected SDEs - Analytic reflections</h1>
                </div>
                <div class="w-100 r-vstack items-center justify-around mb-5">
                    <div class="r-hstack items-center w-100"><img src="figures/constrained/linear_reflection.svg"
                            class="w-25">
                        <div class="w-75" style=" text-align:left">Reflection against a linear boundary.
                            For a step \(s\) with magnitude \(|s|\) and direction \(\hat{s}\) the distance to the
                            boundary
                            described by the normal \(\hat{n}\) and offset \(b\) is \(d=\frac{\innerprod{\hat{s}}{x_t} -
                            b}{\innerprod{\hat{s}}{\hat{n}}}\).
                            The reflected direction is given by \(\hat{s}' = \hat{s} -
                            2\innerprod{\hat{s}}{\hat{n}}\hat{n}\).
                        </div>
                    </div>
                    <div class="r-hstack items-center w-100"><img src="figures/constrained/sphere_reflection.svg"
                            class="w-25">
                        <div class="w-75" style=" text-align:left">For a sphere of radius \(r\), the distance to the
                            boundary from \(x_t\) in
                            direction \(s\) is given by \(d= \frac{1}{2}(\innerprod{\hat{s}}{x_t}^2 + 4 (r^2 -
                            \norm{x_t}^2))^{1/2} -\frac{1}{2}\innerprod{\hat{s}}{x_t}\).
                            The normal at the intersection can be computed as the unit vector in the direction
                            \(-2(d\hat{s} + x_t)\), and then \(\hat{s}'\) as above.
                        </div>
                    </div>
                </div>

            </section>


            <section data-auto-animate="" hidden="" aria-hidden="true" class="future" style="display: block;">
                <div class="r-hstack justify-start h5">
                    <h1>Training and paramtetrising constrained score functions</h1>
                </div>
                <div class="w-100 r-vstack items-center justify-around mb-5">
                    <div class="nice-box w-100" data-id="thm">
                        <b>Implicit score-matching on constrained domains:</b><br>
                        Let \(s \in \mathrm{C}^\infty(\cbr{0,T} \times \R^d, \R^d)\) such that for any \(x \in \partial
                        \c{M}\) and \(t \geq 0\), \(\innerprod{s_t(x)}{\v{n}(x)} = 0\).
                        Then, there exists \(C >0\) such that \[ {\E\sbr{\norm{\nabla \log p_t - s_t}^2} =
                        \E\sbr{\norm{s_t}^2 + 2~ \mathrm{div}(s_t)}} + C , \] where \(\mathbb{E}\) is taken
                        over \(\v{X}_t \sim p_t\) and \(t \sim \mathcal{U}([0,T])\).
                    </div>
                    <ul class="mt-3">
                        <li>Key factor here is that the score function <em>must</em> be tangential to the boundary for
                            the result to hold.
                        </li>
                        <li>We can accomodate this by forcing the score function to be tangential, or zero on the
                            boundary.</li>
                        <li>Forward sampling cannot be done in closed form for either SDE, so we need to do discretised
                            rollouts.</li>
                    </ul>
                </div>

            </section>

            <section data-auto-animate="" hidden="" aria-hidden="true" class="future" style="display: block;">
                <div class="r-stretch r-vstack items-center">
                    <h1 class="h2">Experimental Validation</h1>
                </div>
            </section>

            <section data-auto-animate="" hidden="" aria-hidden="true" class="future" style="display: block;">
                <div class="r-hstack justify-start h5">
                    <h1>On convex polytopes</h1>
                </div>
                <img src="figures/constrained/polytope_densities.png" class="r-stretch">
            </section>

            <section data-auto-animate="" hidden="" aria-hidden="true" class="future" style="display: block;">
                <div class="r-hstack justify-start h5">
                    <h1>On convex polytopes</h1>
                </div>
                <table>
                    <thead>
                        <tr>
                            <th rowspan="2">Space</th>
                            <th rowspan="2">d</th>
                            <th>Log-barrier</th>
                            <th>Reflected</th>
                            <th colspan="2">Euclidean</th>
                        </tr>
                        <tr>
                            <th>MMD</th>
                            <th>MMD</th>
                            <th>MMD</th>
                            <th>% in \(\c{M}\)</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td rowspan="3">\(\sbr{-1, 1}^d\)</td>
                            <td>2</td>
                            <td>\(.066 \pm{.006}\)</td>
                            <td>\(.055 \pm{.015}\)</td>
                            <td>\(.062 \pm{.011}\)</td>
                            <td>98.8</td>
                        </tr>
                        <tr>
                            <td>3</td>
                            <td>\(.209 \pm{.077}\)</td>
                            <td>\(.080 \pm{.004}\)</td>
                            <td>\(.076 \pm{.004}\)</td>
                            <td>98.5</td>
                        </tr>
                        <tr>
                            <td>10</td>
                            <td>\(.330 \pm{.004}\)</td>
                            <td>\(.313 \pm{.048}\)</td>
                            <td>\(.081 \pm{.005}\)</td>
                            <td>96.4</td>
                        </tr>
                        <tr>
                            <td rowspan="3">\(\Delta^d\)</td>
                            <td>2</td>
                            <td>\(.050 \pm{.012}\)</td>
                            <td>\(.043 \pm{.002}\)</td>
                            <td>\(.055 \pm{.013}\)</td>
                            <td>96.4</td>
                        </tr>
                        <tr>
                            <td>3</td>
                            <td>\(.238 \pm{.009}\)</td>
                            <td>\(.181 \pm{.007}\)</td>
                            <td>\(.068\pm{.014}\)</td>
                            <td>96.3</td>
                        </tr>
                        <tr>
                            <td>10</td>
                            <td>\(.275 \pm{.015}\)</td>
                            <td>\(.290 \pm{.009}\)</td>
                            <td>\(.060\pm{.003}\)</td>
                            <td>92.6</td>
                        </tr>
                    </tbody>
                </table>
            </section>


            <section data-auto-animate="" hidden="" aria-hidden="true" class="future" style="display: block;">
                <div class="r-hstack justify-start h5">
                    <h1>On manipulability ellipsoids</h1>
                </div>
                <div class="w-100 r-vstack items-center justify-around mb-5">
                    <ul>
                        <li>Used to define the forces applied by robotic joints</li>
                        <li>Naturally defined as the product of \(\R^d\) and \(\c{S}_{++}^d\).</li>
                    </ul>
                </div>
            </section>

        </div>
    </div>

    <script src="dist/reveal.js">
    </script>
    <script src="plugin/notes/notes.js"></script>
    <!-- <script src="plugin/markdown/markdown.js"></script> -->
    <!-- <script src="plugin/highlight/highlight.js"></script> -->
    <script src="plugin/math/math.js"></script>

    <script>
        // More info about initialization & config:
        // - https://revealjs.com/initialization/
        // - https://revealjs.com/config/
        document.addEventListener("DOMContentLoaded", () => {
            // Reveal.initialize({
            //     hash: true,
            //     center: false,
            //     width: 1280,
            //     height: 800,
            //     maxScale: 5.0,
            //     slideNumber: true,
            //     transition: "fade",
            //     keyboard: { 27: null },
            //     pdfSeparateFragments: false
            // });
            Reveal.on('pdf-ready', () =>
                document.querySelectorAll("section[data-no-print]").forEach(e => e.parentNode.remove())
            );
            document.querySelectorAll("*[data-class]").forEach(e => e.dataset.class.split(" ").forEach(c => e.classList.add(c)));
        });
        Reveal.initialize({
            hash: true,
            center: false,
            width: 1280,
            height: 800,
            maxScale: 5.0,
            slideNumber: true,
            transition: "fade",
            pdfSeparateFragments: !0,
            pdfSeparateFragments: false,
            katex: {
                verison: 'latest',
                delimiters: [
                    { left: "$$", right: "$$", display: true },
                    { left: "$", right: "$", display: false },
                    { left: "\\[", right: "\\]", display: true },
                    { left: "\\(", right: "\\)", display: false },
                ],
                trust: true,
                strict: false,
                macros: {
                    "\\P": "\\mathbb{P}",
                    "\\E": "\\mathbb{E}",
                    "\\Cov": "\\operatorname{Cov}",
                    "\\N": "\\mathbb{N}",
                    "\\Z": "\\mathbb{Z}",
                    "\\Q": "\\mathbb{Q}",
                    "\\R": "\\mathbb{R}",
                    "\\C": "\\mathbb{C}",
                    "\\eps": "\\varepsilon",
                    "\\given": "\\mid",
                    "\\d": "{\\operatorname{d}}",
                    "\\v": "\\boldsymbol{#1}",
                    "\\m": "\\mathbf{#1}",
                    "\\f": "\\operatorname{#1}",
                    "\\s": "\\mathscr{#1}",
                    "\\c": "\\mathcal{#1}",
                    "\\bb": "\\mathbb{#1}",
                    "\\del": "\\left({#1}\\right)",
                    "\\sbr": "\\left[{#1}\\right]",
                    "\\cbr": "\\left\\{ {#1} \\right\\}",
                    "\\x": "\\times",
                    "\\t": "\\mathbin{\\text{#1}}",
                    "\\norm": "\\left\\Vert{#1}\\right\\Vert",
                    "\\innerprod": "\\left\\langle{#1},{#2}\\right\\rangle",
                    "\\pd": "\\partial",
                    "\\o": "\\circ",
                    "\\.": "\\cdot",
                    "\\h": "\\widehat{#1}",
                    "\\dive": "{\\operatorname{div}}",
                    "\\abs": "|#1|",
                    "\\~": "\\sim",
                    "\\ubr": "\\underset{\\mathclap{#2}}{\\undergroup{#1}}",
                    "\\drift": "\\textcolor{blue}{b(t, \\X)}",
                    "\\noise": "\\textcolor{red}{\\sigma(t)}",
                    "\\score": "\\textcolor{orange}{\\nabla_{\\m{X}}\\log p_t(\\X)}",
                    "\\driftrev": "\\textcolor{blue}{-b(T-t, \\Y)}",
                    "\\noiserev": "\\textcolor{red}{\\sigma(T-t)}",
                    "\\scorerev": "\\textcolor{orange}{\\nabla_{\\m{X}}\\log p_{T-t}(\\Y)}",
                    "\\langdrift": "\\textcolor{blue}{-\\nabla_{\\m{X}}U(\\X)}",
                    "\\langnoise": "\\textcolor{red}{\\sqrt{2}}",
                    "\\brownian": "\\d \\m{B}_t",
                    "\\condscore": "{\\nabla_{\\m{X}_t}\\log p_{t|0}(\\m{X}_t | \\m{X}_0)}",

                    "\\X": "\\m{X}_t",
                    "\\Y": "\\m{Y}_t",
                    "\\SE": "\\operatorname{SE}",
                    "\\SU": "\\operatorname{SU}",
                    "\\SO": "\\operatorname{SO}",
                    "\\vsra": "\\mathchoice{\\includegraphics[height=1.1ex]{figures/icons/veryshortrightarrow.svg}}{\\includegraphics[height=1.1ex]{figures/icons/veryshortrightarrow.svg}}{\\includegraphics[height=.8ex]{figures/icons/veryshortrightarrow.svg}}{\\includegraphics[height=.5ex]{figures/icons/veryshortrightarrow.svg}}",
                    "\\vsla": "\\mathchoice{\\includegraphics[height=1.1ex]{figures/icons/veryshortleftarrow.svg}}{\\includegraphics[height=1.1ex]{figures/icons/veryshortleftarrow.svg}}{\\includegraphics[height=.8ex]{figures/icons/veryshortleftarrow.svg}}{\\includegraphics[height=.5ex]{figures/icons/veryshortleftarrow.svg}}",
                }
            },
            // Learn about plugins: https://revealjs.com/plugins/
            plugins: [RevealNotes, RevealMath.KaTeX]
        });
    </script>
</body>

</html>